(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    128809,       2871]
NotebookOptionsPosition[    113538,       2627]
NotebookOutlinePosition[    113989,       2645]
CellTagsIndexPosition[    113946,       2642]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Observability Analysis: Rotary-Wing UAV with Aerodynamic Drag\
\>", "Title",
 CellChangeTimes->{{3.866795976340993*^9, 3.866795999559713*^9}, {
  3.866797518695778*^9, 3.866797519037809*^9}, {3.8798478524655704`*^9, 
  3.8798478722018995`*^9}, {3.9723935208563385`*^9, 
  3.9723935226216526`*^9}},ExpressionUUID->"1bc5922d-ca10-4f41-a4da-\
454549fec2cc"],

Cell["Spencer Folk", "Subtitle",
 CellChangeTimes->{{3.8667960141896915`*^9, 3.8667960322791953`*^9}, {
  3.8667966817695827`*^9, 3.8667966838137655`*^9}, {3.8668177417744465`*^9, 
  3.866817744224984*^9}, {3.8668228580680437`*^9, 3.8668228769034643`*^9}, {
  3.8798478503005285`*^9, 
  3.879847850464737*^9}},ExpressionUUID->"102ab1a5-78bc-49f4-beac-\
64501c2507e7"],

Cell[CellGroupData[{

Cell["System Parameters", "Section",
 CellChangeTimes->{{3.8667979485916348`*^9, 
  3.866797977151947*^9}},ExpressionUUID->"8a0ef6c2-7f27-4cdb-aedb-\
9df0d3be3377"],

Cell[CellGroupData[{

Cell["Inertia, Mass, and Gravity", "Subsubsection",
 CellChangeTimes->{{3.8667967451889434`*^9, 3.866796749180997*^9}, {
  3.866797847963836*^9, 
  3.8667978549489803`*^9}},ExpressionUUID->"9165a4d7-169d-4398-aced-\
7c9ac5d72c19"],

Cell["\<\
In this  version of the dynamics, we consider a body frame (B) and inertial \
frame (W). Without loss of generality, we assume the body frame is the \
principal axes such that the inertia tensor is diagonal. \
\>", "Text",
 CellChangeTimes->{{3.866823365076543*^9, 3.8668233923381033`*^9}, {
   3.8668234356944413`*^9, 3.8668235369021854`*^9}, {3.869140178446459*^9, 
   3.8691402806836853`*^9}, {3.8691453589559913`*^9, 
   3.8691453634448366`*^9}, {3.8798479279952197`*^9, 3.879847978326247*^9}, 
   3.879851147404834*^9, 
   3.972393528639099*^9},ExpressionUUID->"f1eba1fd-c645-42e5-ae4b-\
6008f7d3abec"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"j", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"jx", ",", " ", "jy", ",", " ", "jz"}], "}"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Measured", " ", 
     StyleBox["a",
      FontSlant->"Italic"], 
     StyleBox[" ",
      FontSlant->"Italic"], 
     StyleBox["priori",
      FontSlant->"Italic"]}], ",", " ", 
    RowBox[{
    "either", " ", "using", " ", "CAD", " ", "or", " ", "something", " ", 
     "more", " ", "complicated"}]}], " ", "*)"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"jmat", " ", "=", " ", 
   RowBox[{"DiagonalMatrix", "[", "j", "]"}]}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"jmatInv", " ", "=", " ", 
    RowBox[{"Inverse", "[", "jmat", "]"}]}], ";"}], " "}]}], "Input",
 CellChangeTimes->{{3.8667960487466097`*^9, 3.8667960587869606`*^9}, {
  3.8667961012114134`*^9, 3.866796136215488*^9}, {3.866796172674283*^9, 
  3.8667962099750443`*^9}, {3.866796269346722*^9, 3.8667962907039356`*^9}, {
  3.866796327515772*^9, 3.8667963506269407`*^9}, {3.866797133658988*^9, 
  3.866797136761545*^9}, {3.86682064240816*^9, 3.866820828419489*^9}, {
  3.86682101432417*^9, 3.866821018696756*^9}, {3.866822905456602*^9, 
  3.866822923238988*^9}, {3.8668233954448385`*^9, 3.866823423763429*^9}},
 CellLabel->
  "In[1158]:=",ExpressionUUID->"a8bd066b-aa7a-43bc-b0d7-c0c6828401ee"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"jx", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "jy", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "jz"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8667974427869945`*^9, 3.866797465368078*^9}, 
   3.866797600268939*^9, {3.866797844220096*^9, 3.8667978657223344`*^9}, {
   3.8667997872224293`*^9, 3.866799812591072*^9}, 3.8667998541460896`*^9, 
   3.866799901691491*^9, 3.866799962373826*^9, 3.8667999954620504`*^9, 
   3.8668000585525937`*^9, {3.866800117664752*^9, 3.8668001552496333`*^9}, 
   3.866800256654237*^9, {3.8668003484760127`*^9, 3.8668003678493004`*^9}, {
   3.866800415914959*^9, 3.866800440546075*^9}, 3.866802560869521*^9, 
   3.8668025928775396`*^9, 3.8668026915928707`*^9, {3.8668027645132036`*^9, 
   3.866802777797859*^9}, 3.8668029258929996`*^9, {3.8668029646200447`*^9, 
   3.8668029924812455`*^9}, {3.8668031705399494`*^9, 
   3.8668031852717943`*^9}, {3.8668032635035486`*^9, 3.8668032733548174`*^9}, 
   3.8668033773478785`*^9, {3.866803597990518*^9, 3.8668036100399427`*^9}, 
   3.8668036546813936`*^9, 3.866803753337022*^9, 3.8668039089744816`*^9, {
   3.866803968810217*^9, 3.8668040404513493`*^9}, 3.8668042237722683`*^9, 
   3.8668045188890038`*^9, 3.866804696517474*^9, 3.866804919746397*^9, 
   3.8668069968768697`*^9, 3.8668071677461967`*^9, 3.8668073013142548`*^9, {
   3.866807397250407*^9, 3.8668074204020195`*^9}, {3.866807464079712*^9, 
   3.8668074987079444`*^9}, {3.866807543404195*^9, 3.866807576833886*^9}, 
   3.8668076876290116`*^9, {3.8668077460062857`*^9, 3.866807767074682*^9}, 
   3.866807814721857*^9, 3.866807867289683*^9, 3.8668079904843516`*^9, 
   3.866808048250745*^9, 3.866808183312522*^9, 3.866808415338072*^9, 
   3.8668157605392475`*^9, 3.866815802088619*^9, 3.866815833436996*^9, 
   3.866815867206925*^9, {3.866815915995303*^9, 3.8668159709119473`*^9}, 
   3.8668160085737963`*^9, {3.866816095008246*^9, 3.8668161071471386`*^9}, {
   3.8668161848906865`*^9, 3.8668162171659155`*^9}, {3.866816290888957*^9, 
   3.866816296919651*^9}, {3.866816391259852*^9, 3.8668164702258463`*^9}, 
   3.866816539589718*^9, {3.866816592609651*^9, 3.866816642667121*^9}, {
   3.8668166799703064`*^9, 3.866816720444496*^9}, {3.8668167570541573`*^9, 
   3.86681679219147*^9}, 3.866816832905397*^9, 3.86681690053849*^9, 
   3.8668169437875175`*^9, 3.8668170416553144`*^9, 3.8668173260869884`*^9, {
   3.866817365331068*^9, 3.866817390504591*^9}, 3.866817527341434*^9, 
   3.8668176085399103`*^9, {3.8668176418188095`*^9, 3.866817668479041*^9}, 
   3.866817753618825*^9, 3.866817845978016*^9, 3.866817967784498*^9, {
   3.8668194665751257`*^9, 3.8668194907536726`*^9}, 3.8668195516404037`*^9, 
   3.8668196260532875`*^9, 3.8668197319957685`*^9, {3.8668197636615133`*^9, 
   3.8668197884865403`*^9}, 3.8668198525476084`*^9, {3.866819930001915*^9, 
   3.8668199556167307`*^9}, {3.8668200778537483`*^9, 3.866820096737373*^9}, 
   3.86682016311649*^9, {3.8668202522637405`*^9, 3.866820277357658*^9}, 
   3.8668207533120813`*^9, 3.8668210437684603`*^9, 3.866821082839981*^9, 
   3.8668212727840853`*^9, 3.8668214455685744`*^9, {3.86682165398089*^9, 
   3.866821731375848*^9}, 3.8668219539092855`*^9, 3.866822348373615*^9, 
   3.8668236463644524`*^9, 3.8668239819455724`*^9, 3.86741177245354*^9, 
   3.867412098047966*^9, {3.867413506273595*^9, 3.867413526517286*^9}, 
   3.8674136703572917`*^9, {3.8674143748145947`*^9, 3.8674143932133074`*^9}, 
   3.867414494610701*^9, 3.8674146164116154`*^9, 3.867414742717224*^9, {
   3.867414814243318*^9, 3.867414881808965*^9}, 3.8674149137446375`*^9, 
   3.867414966740327*^9, 3.8674156133424673`*^9, 3.867415666089572*^9, 
   3.8674157163813524`*^9, {3.8674157504772053`*^9, 3.8674157844266553`*^9}, 
   3.8674158202594852`*^9, 3.867415938655345*^9, 3.8674160749075613`*^9, 
   3.8674161903165455`*^9, 3.867416307474653*^9, 3.8674163633370905`*^9, 
   3.867417102694631*^9, 3.867417155590218*^9, 3.867417255506425*^9, 
   3.867769618578945*^9, 3.867769993072942*^9, 3.8677701151937027`*^9, 
   3.8677720907776546`*^9, 3.867772472633875*^9, 3.867844470606861*^9, 
   3.867844575510213*^9, 3.8678448259113955`*^9, 3.8678448718931394`*^9, 
   3.8678449178986406`*^9, 3.867845133421485*^9, 3.8678451733040023`*^9, 
   3.867845308113882*^9, 3.867845395076005*^9, 3.8678455649376144`*^9, 
   3.867846615334386*^9, {3.8678477688599896`*^9, 3.86784778172709*^9}, 
   3.8678479058725214`*^9, 3.867847951707212*^9, 3.867849549405078*^9, 
   3.867942933011239*^9, 3.8679430170046926`*^9, 3.8691399430888386`*^9, {
   3.869140043043251*^9, 3.8691400529355536`*^9}, {3.8691401012817373`*^9, 
   3.8691401243844447`*^9}, 3.869141758527441*^9, 3.8691417961070585`*^9, 
   3.8691419290640726`*^9, 3.8691420762575755`*^9, 3.8691424871545916`*^9, 
   3.869145841875027*^9, 3.869146159604295*^9, 3.8691463197681637`*^9, 
   3.8691464396175075`*^9, 3.8691466198568077`*^9, 3.8691466869128065`*^9, {
   3.86914742777503*^9, 3.8691474491117435`*^9}, {3.8691474815614376`*^9, 
   3.869147491345536*^9}, 3.869147522376485*^9, {3.869147567648788*^9, 
   3.86914757618781*^9}, 3.8691476482536025`*^9, 3.869147678534545*^9, {
   3.8691488215211315`*^9, 3.8691488422841454`*^9}, 3.869149014564536*^9, {
   3.8691496208731966`*^9, 3.869149688499926*^9}, 3.8691498933456187`*^9, {
   3.8691499285182953`*^9, 3.869149968186204*^9}, 3.8691499987055373`*^9, 
   3.869150655168397*^9, 3.8691508915938983`*^9, 3.8691510910179186`*^9, {
   3.869151206080042*^9, 3.8691512239284744`*^9}, {3.8691515568018045`*^9, 
   3.8691516069256887`*^9}, 3.8691516618836513`*^9, {3.8691517164199266`*^9, 
   3.8691517445507345`*^9}, 3.8692228294727926`*^9, 3.869223099829113*^9, 
   3.8692232417200603`*^9, 3.869228108618509*^9, 3.869229721386922*^9, 
   3.8692350778748093`*^9, 3.8693044254623966`*^9, 3.8693045574169717`*^9, 
   3.86930600433435*^9, 3.8698437514776173`*^9, 3.869845154385827*^9, 
   3.869845370141032*^9, {3.8704265718530416`*^9, 3.870426597799138*^9}, 
   3.870427077939576*^9, 3.870427619795602*^9, 3.879851265350193*^9, {
   3.8798513703951044`*^9, 3.8798513869246187`*^9}, {3.879851503427356*^9, 
   3.8798515636582336`*^9}, 3.879851706903996*^9, 3.879851739635268*^9, 
   3.879851929634926*^9, {3.8798519727044983`*^9, 3.8798519839556866`*^9}, 
   3.8798520639822116`*^9, 3.8798521753963675`*^9, 3.8798522635456676`*^9, 
   3.8798523365272684`*^9, {3.879852822563186*^9, 3.8798528310905647`*^9}, 
   3.8798528951025896`*^9, 3.8798530644530835`*^9, 3.8798531029202538`*^9, 
   3.8799491088029504`*^9, 3.8799500898329697`*^9, {3.8799501553674707`*^9, 
   3.8799501732764187`*^9}, 3.879950403505783*^9, 3.8824445055658712`*^9, 
   3.8824445558060737`*^9, 3.8824448888452215`*^9, 3.8824451520039387`*^9, 
   3.8824458303411937`*^9, 3.8824459268774185`*^9, 3.8824459832761464`*^9, 
   3.882446020930815*^9, 3.882446157535967*^9, 3.882446190308*^9, 
   3.8824462595886574`*^9, {3.8824463314957495`*^9, 3.8824463552578087`*^9}, 
   3.8824464146697283`*^9, {3.882446455542164*^9, 3.882446478869116*^9}, 
   3.882446516395926*^9, {3.8824465569750996`*^9, 3.882446700402622*^9}, {
   3.882446734391721*^9, 3.8824467515909843`*^9}, 3.8824467976797595`*^9, 
   3.882448118307206*^9, 3.882448203636445*^9, {3.8824482520249467`*^9, 
   3.882448404871891*^9}, {3.882448435586149*^9, 3.8824484483063865`*^9}, {
   3.8824484828610954`*^9, 3.8824485446207294`*^9}, {3.8824485887966595`*^9, 
   3.8824486231767035`*^9}, 3.882448667451316*^9, {3.882448703518303*^9, 
   3.882448723804047*^9}, {3.8824487552486296`*^9, 3.8824487763306828`*^9}, 
   3.8824489115887156`*^9, 3.88244948054533*^9, 3.882449773576989*^9, 
   3.9526808392058773`*^9, 3.9526809128177433`*^9, {3.9526809683273125`*^9, 
   3.952680992107441*^9}, 3.9526810397676487`*^9, 3.9526811352190304`*^9, 
   3.9526811694291*^9, 3.952681231625532*^9, 3.972393955057556*^9, {
   3.9723951511993923`*^9, 3.9723951869261456`*^9}, 3.9723954583508224`*^9, 
   3.9723956101572723`*^9, 3.9723958034185905`*^9, 3.972395876535015*^9, 
   3.972395972675457*^9, 3.9723960552156563`*^9},
 CellLabel->
  "Out[1159]=",ExpressionUUID->"0c0531a7-aa71-6545-b8ec-844b9462c9d7"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"m", ";", " ", "g", ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"Measured", " ", 
    StyleBox["a",
     FontSlant->"Italic"], 
    StyleBox[" ",
     FontSlant->"Italic"], 
    StyleBox["priori",
     FontSlant->"Italic"]}], 
   StyleBox[" ",
    FontSlant->"Italic"], "*)"}]}]], "Input",
 CellChangeTimes->{{3.8667978329295444`*^9, 3.866797857520125*^9}, {
  3.8668166312614164`*^9, 3.8668166362577567`*^9}, {3.8668208333203864`*^9, 
  3.8668208476338215`*^9}, {3.866821188220186*^9, 3.8668211906871457`*^9}, {
  3.8668212585361247`*^9, 3.8668212587770357`*^9}, {3.866821299737344*^9, 
  3.8668213060818377`*^9}, {3.8691454034484663`*^9, 3.869145422970561*^9}},
 CellLabel->
  "In[1161]:=",ExpressionUUID->"4dc6eba7-2d7d-4316-a601-11480a42599e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Motor Coefficients", "Subsubsection",
 CellChangeTimes->{{3.8798483940509024`*^9, 
  3.879848399405017*^9}},ExpressionUUID->"94e44778-561f-4c49-a0ec-\
68f4876517c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Tau]m", ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "first", " ", "order", " ", "time", " ", "constant", " ", "of", " ", "the",
     " ", "motor", " ", "response"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.8798484047116594`*^9, 3.879848422694869*^9}},
 CellLabel->
  "In[1162]:=",ExpressionUUID->"41102483-292e-43c5-a351-b7c533f0383e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Propeller Coefficients", "Subsubsection",
 CellChangeTimes->{{3.866796762143897*^9, 
  3.866796765252455*^9}},ExpressionUUID->"ad48e579-a9e2-4ec6-b4fc-\
688ea11bf14c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"k\[Eta]", ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"Thrust", " ", "coefficient"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"km", ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"Yaw", " ", "moment", " ", "coefficient"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kd", ";"}], "   ", 
  RowBox[{"(*", " ", 
   RowBox[{"Rotor", " ", "drag", " ", "coefficient"}], " ", "*)"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kz", ";"}], "   ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Loss", " ", "of", " ", "thrust", " ", "due", " ", "to", " ", "inflow"}], 
    ",", " ", 
    RowBox[{"inflow", " ", "coefficient"}]}], " ", "*)"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kh", ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Translational", " ", "lift", " ", "coefficient"}], " ", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8667963550467415`*^9, 3.8667963802426815`*^9}, {
  3.869151067926915*^9, 3.86915107835617*^9}, {3.869151568308358*^9, 
  3.8691515768525934`*^9}, {3.8798481668980055`*^9, 3.8798481677469096`*^9}, {
  3.8798483569468946`*^9, 3.879848374821068*^9}, {3.8798484264207067`*^9, 
  3.879848466667345*^9}, {3.879849472328328*^9, 3.879849478046983*^9}, {
  3.879851809465643*^9, 3.879851810011842*^9}, {3.879852075024952*^9, 
  3.879852076680573*^9}, {3.9526806081861706`*^9, 3.952680616452982*^9}, {
  3.9723935843382225`*^9, 3.972393584694071*^9}},
 CellLabel->
  "In[1163]:=",ExpressionUUID->"c4a40691-4620-4bf8-ba88-5805d4c0506b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Propeller Position Vectors", "Subsubsection",
 CellChangeTimes->{{3.8667967910121555`*^9, 
  3.8667968021334524`*^9}},ExpressionUUID->"3ee51c0b-c96c-44a8-82a9-\
57b0f80da9ff"],

Cell["\<\
These vectors are written in the body frame (note the B in front of each \
vector). Since we choose the body frame, we can assume that these values can \
be easily measured in CAD and therefore known. Without loss of generality, we \
consider a planar symmetric configuration. \
\>", "Text",
 CellChangeTimes->{
  3.866823354297919*^9, {3.8691402978079295`*^9, 3.869140350693522*^9}, {
   3.8798484802999516`*^9, 3.8798485234410076`*^9}, {3.8798494960784235`*^9, 
   3.8798494970905*^9}, {3.9723936046441193`*^9, 
   3.9723936059641*^9}},ExpressionUUID->"409f6702-9328-4f96-9c1a-\
f249d4f47fb9"],

Cell[BoxData[
 RowBox[{"l", ";", " ", "d", ";"}]], "Input",
 CellChangeTimes->{{3.870426534669002*^9, 3.870426568005004*^9}, {
  3.8798485260830545`*^9, 3.8798485303304253`*^9}, {3.879950106038001*^9, 
  3.8799501101871185`*^9}, {3.8824463872663484`*^9, 3.882446400703199*^9}},
 CellLabel->
  "In[1168]:=",ExpressionUUID->"46169f26-f452-4bde-a0c3-29c670c2aca2"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BpBR1", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"l", ",", "0", ",", "d"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BpBR2", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "l", ",", "d"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BpBR3", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "l"}], ",", "0", ",", "d"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BpBR4", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "l"}], ",", "d"}], "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8691456336841884`*^9, 3.8691457070858803`*^9}, {
   3.8691457386536074`*^9, 3.869145787393863*^9}, {3.8704265487503614`*^9, 
   3.8704266398190556`*^9}, {3.8704276078947086`*^9, 
   3.8704276141796284`*^9}, {3.8704277371485715`*^9, 3.870427741555299*^9}, 
   3.8798484967185183`*^9, {3.879848531559823*^9, 3.8798485426786385`*^9}, {
   3.8799501118098264`*^9, 3.8799501331201854`*^9}, {3.8824464024270344`*^9, 
   3.8824464106748967`*^9}},
 CellLabel->
  "In[1169]:=",ExpressionUUID->"ddd2b957-9208-4480-a097-a40f1a5ab919"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Propeller Rotation Directions", "Subsubsection",
 CellChangeTimes->{{3.8667976488337564`*^9, 
  3.866797656842596*^9}},ExpressionUUID->"284db6f0-fb7d-4e19-b123-\
7d4ce2b6c6e4"],

Cell["\<\
These reflect the direction of each motor,observability result should be \
invariant to these but it\[CloseCurlyQuote]s here for completeness. These \
results should hold without loss of generality. \
\>", "Text",
 CellChangeTimes->{
  3.8668233422083855`*^9, {3.8677719763547606`*^9, 
   3.8677719932974014`*^9}},ExpressionUUID->"644f1d55-4e72-4b0c-b93c-\
6b46194520bc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Epsilon]", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"1", ",", " ", 
     RowBox[{"-", "1"}], ",", "1", ",", 
     RowBox[{"-", "1"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8667976614185743`*^9, 3.8667976732726097`*^9}, 
   3.866817836082217*^9, {3.8677719736039295`*^9, 3.867771973807118*^9}, {
   3.879848578896469*^9, 3.879848580301569*^9}},
 CellLabel->
  "In[1173]:=",ExpressionUUID->"4ecfafcf-4e8e-4046-a8b9-d084ca36dac2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["IMU  Position Vector and Rotation", "Subsubsection",
 CellChangeTimes->{{3.866796904162329*^9, 3.866796911087702*^9}, {
  3.8667972369185343`*^9, 
  3.866797239510627*^9}},ExpressionUUID->"36e6cf5a-bbbf-4448-859e-\
458345ba5142"],

Cell["\<\
The position and rotation of the IMU frame with respect to the body frame. \
Without loss of generality, choose identity with zero offset from CoM. \
\>", "Text",
 CellChangeTimes->{{3.866823327413368*^9, 3.8668233295834527`*^9}, {
  3.8798485899180803`*^9, 
  3.8798486206205573`*^9}},ExpressionUUID->"f51abaf0-0256-47ce-a01f-\
d7cc30366a0b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BpBI", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", "0", ",", " ", "0"}], "}"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"xyz", " ", "position", " ", "of", " ", "the", " ", "IMU", " ", 
     RowBox[{"w", ".", "r", ".", "t", ".", " ", "the"}], " ", "body", " ", 
     "axes"}], ",", " ", 
    RowBox[{
    "in", " ", "which", " ", "case", " ", "we", " ", "assume", " ", "to", " ",
      "be", " ", "known"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]I", "=", "0"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Yaw", " ", "angle", " ", "of", " ", "IMU", " ", "frame", " ", "from", " ",
     "body", " ", "axes"}], "*)"}], " "}], "\[IndentingNewLine]", 
 RowBox[{"IRB", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Psi]I", "]"}], ",", " ", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Psi]I", "]"}]}], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Psi]I", "]"}], ",", " ", 
      RowBox[{"Cos", "[", "\[Psi]I", "]"}], ",", " ", "0"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "Recall", " ", "that", " ", "we", " ", "assume", " ", "that", " ", "IMU", " ",
     "z", " ", "axis", " ", "and", " ", "principal", " ", "z", " ", "axis", " ",
     "are", " ", "parallel"}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQPWmrdX7I+TeODAukCkH0zVfG00B0UemmGSB63+nX
c0F0lcmxTSA6ZlbNl1ggraoz/SuIjr0fzxkHpLWcO8H0m1hRVRB9hUsOTKdE
f6gF0fN+xdaB6CW1h3pA9Jbjp8H04r973sYD6Zovyl9AtFvFPecEIB2QcN0F
RD+Tuh0IotP89gWBaIGakAgQfUHUKxZEz1FhUUsE0pduGYDpeVUT9EH0JL2f
YJo/YeXb4ItvHLcXKr0D0VHeZT9BdETWk18g2sqkRS4ESFfVTpIH0T+u5Gw/
c/mNo8gt5v0guqvIquI8kD6k5lgDoiecV1a5AKRPfJulBqLLUpSlvgLpXXsO
KoFoAN5JuqE=
  "],
 CellLabel->
  "In[1174]:=",ExpressionUUID->"2144a647-e5b9-40b3-8927-281d9ec290b3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.869147427870037*^9, 3.8691474492087517`*^9}, {
   3.8691474816336436`*^9, 3.869147491420538*^9}, 3.869147522446591*^9, {
   3.869147567723795*^9, 3.8691475762493362`*^9}, 3.869147648336605*^9, 
   3.8691476785975513`*^9, {3.869148821600975*^9, 3.869148842344149*^9}, 
   3.8691490146406903`*^9, {3.8691496209532013`*^9, 3.8691496885619297`*^9}, 
   3.8691498934076233`*^9, {3.869149928574298*^9, 3.8691499682492104`*^9}, 
   3.8691499987635417`*^9, 3.8691506552334023`*^9, 3.869150891667094*^9, 
   3.869151091125929*^9, {3.8691512061932917`*^9, 3.869151224029483*^9}, {
   3.86915155691181*^9, 3.869151606993694*^9}, 3.8691516619506617`*^9, {
   3.869151716489113*^9, 3.869151744611192*^9}, 3.869222829597818*^9, 
   3.8692230999411435`*^9, 3.8692232419150763`*^9, 3.869228108803518*^9, 
   3.8692297215460014`*^9, 3.8692350780738277`*^9, 3.8693044257424154`*^9, 
   3.869304557659483*^9, 3.8693060045192814`*^9, 3.8698437516627192`*^9, 
   3.8698451545548177`*^9, 3.8698453702800198`*^9, {3.8704265723774104`*^9, 
   3.870426597989693*^9}, 3.87042707812359*^9, 3.87042762002117*^9, 
   3.879851265415202*^9, {3.8798513704639845`*^9, 3.879851386992625*^9}, {
   3.879851503508712*^9, 3.8798515637242346`*^9}, 3.8798517069600005`*^9, 
   3.8798517396882133`*^9, 3.879851929785944*^9, {3.8798519728318815`*^9, 
   3.879851984084001*^9}, 3.879852064136563*^9, 3.8798521754963765`*^9, 
   3.8798522636396637`*^9, 3.879852336620279*^9, {3.879852822607189*^9, 
   3.879852831147566*^9}, 3.8798528951525936`*^9, 3.8798530645004168`*^9, 
   3.879853102971259*^9, 3.879949108850953*^9, 3.8799500898909755`*^9, {
   3.8799501554114733`*^9, 3.8799501733304214`*^9}, 3.8799504035502453`*^9, 
   3.8824445056688795`*^9, 3.882444555914081*^9, 3.8824448889562483`*^9, 
   3.8824451521188903`*^9, 3.882445830434201*^9, 3.8824459269844255`*^9, 
   3.882445983366153*^9, 3.882446021025827*^9, 3.8824461576301365`*^9, 
   3.8824461904030075`*^9, 3.882446259677664*^9, {3.8824463315787554`*^9, 
   3.8824463553558235`*^9}, 3.882446414800009*^9, {3.882446455671174*^9, 
   3.8824464789561176`*^9}, 3.882446516482935*^9, {3.8824465570541077`*^9, 
   3.882446700512633*^9}, {3.8824467345147314`*^9, 3.882446751673991*^9}, 
   3.882446797773126*^9, 3.882448118428216*^9, 3.8824482037654843`*^9, {
   3.882448252139227*^9, 3.8824484049763155`*^9}, {3.8824484356800685`*^9, 
   3.8824484484052496`*^9}, {3.8824484829460864`*^9, 3.882448544700574*^9}, {
   3.8824485889096107`*^9, 3.8824486232801895`*^9}, 3.882448667542036*^9, {
   3.8824487036247*^9, 3.882448723936299*^9}, {3.882448755388523*^9, 
   3.8824487764542522`*^9}, 3.882448911686772*^9, 3.882449480671339*^9, 
   3.882449773746002*^9, 3.952680839253706*^9, 3.952680912859167*^9, {
   3.952680968551918*^9, 3.9526809922675495`*^9}, 3.952681040101034*^9, 
   3.952681135263241*^9, 3.9526811695680046`*^9, 3.9526812316542454`*^9, 
   3.9723939551774406`*^9, {3.972395151224661*^9, 3.972395186935871*^9}, 
   3.9723954583658714`*^9, 3.9723956101697845`*^9, 3.972395803431553*^9, 
   3.972395876543907*^9, 3.972395972740696*^9, 3.9723960552406826`*^9},
 CellLabel->
  "Out[1176]=",ExpressionUUID->"0dc3457a-161a-e942-8fbe-98c0387b40a0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["IMU biases", "Subsubsection",
 CellChangeTimes->{{3.8667978037632065`*^9, 
  3.8667978051175394`*^9}},ExpressionUUID->"21e90ca2-2bd3-4b30-a5bf-\
b44915b0ca9c"],

Cell["\<\
Typically these biases can be calibrated at the beginning of the flight. \
\>", "Text",
 CellChangeTimes->{
  3.8668235594321065`*^9, {3.87984864175339*^9, 3.8798486607269726`*^9}, {
   3.9723936371341953`*^9, 
   3.972393644683939*^9}},ExpressionUUID->"e4a240af-3aed-4e2e-bde2-\
5bafb7d35504"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ba", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"bax", ",", " ", "bay", ",", " ", "baz"}], "}"}]}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bg", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"bgx", ",", " ", "bgy", ",", " ", "bgz"}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8667978097972527`*^9, 3.866797823026213*^9}, {
  3.8668211631810875`*^9, 3.86682117924308*^9}, {3.866821292290905*^9, 
  3.866821296691047*^9}, {3.866823554886165*^9, 3.8668235567719474`*^9}},
 CellLabel->
  "In[1177]:=",ExpressionUUID->"5e060d44-a5f8-4ad5-be1c-36515c0ac24c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["System States", "Section",
 CellChangeTimes->{{3.8667980449623184`*^9, 
  3.866798045978372*^9}},ExpressionUUID->"a604a669-c4f8-49bd-a574-\
9ae555ef816b"],

Cell[CellGroupData[{

Cell["Inertial Position", "Subsubsection",
 CellChangeTimes->{{3.8798489167241945`*^9, 
  3.879848925293064*^9}},ExpressionUUID->"553a1ab9-20d4-423e-a457-\
0706819e2005"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Wpos", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"xpos", ",", " ", "ypos", ",", " ", "zpos"}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.879848931641199*^9, 3.8798489346741505`*^9}, {
  3.882444033440946*^9, 3.8824440453465614`*^9}},
 CellLabel->
  "In[1179]:=",ExpressionUUID->"ab6424f2-1d35-4a9b-b1a8-b7f28a2c79d4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Body Attitude (Represented with Euler Angles)", "Subsubsection",
 CellChangeTimes->{{3.8668004838072853`*^9, 3.866800523551*^9}, {
  3.8798487134269457`*^9, 3.879848715331749*^9}, {3.8798501051323104`*^9, 
  3.879850106115769*^9}},ExpressionUUID->"81361ef9-6d7d-45bc-969e-\
961be53e37db"],

Cell["The body attitude is represented using Euler angles. ", "Text",
 CellChangeTimes->{
  3.866804615877006*^9, {3.8668229837236347`*^9, 3.8668230074056287`*^9}, {
   3.8668235705450726`*^9, 3.8668235751623745`*^9}, {3.879848718363553*^9, 
   3.879848730449263*^9}, {3.879849040229946*^9, 3.8798490408541603`*^9}, {
   3.8824442123313513`*^9, 
   3.882444213202626*^9}},ExpressionUUID->"de8ef314-5fd5-4f00-926d-\
e4abb055bb9f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Theta]", ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Pitch", " ", "angle", " ", "about", " ", "the", " ", "y", " ", "axis"}], 
   " ", "*)"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Psi]", ";"}], "   ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Yaw", " ", "angle", " ", "about", " ", "the", " ", "z", " ", "axis"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]", ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Roll", " ", "angle", " ", "about", " ", "the", " ", "x", " ", "axis"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalTheta]", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"\[Phi]", ",", " ", "\[Theta]", ",", " ", "\[Psi]"}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.86680252144567*^9, 3.8668025891551356`*^9}, {
  3.866816815462734*^9, 3.866816815707508*^9}, {3.8668205341601934`*^9, 
  3.8668205559056196`*^9}, {3.866821367575635*^9, 3.8668213718505726`*^9}, {
  3.8798487095361204`*^9, 3.879848749184181*^9}, {3.879850112823471*^9, 
  3.8798501248549166`*^9}, {3.879850567815385*^9, 3.87985060417948*^9}, {
  3.882444082855607*^9, 3.88244411137932*^9}, {3.8824442156653895`*^9, 
  3.882444221558303*^9}},
 CellLabel->
  "In[1180]:=",ExpressionUUID->"128354d4-8bd0-465a-b0fd-720f49c70571"],

Cell["Construct the elementary rotation matrices", "Text",
 CellChangeTimes->{{3.8798507499262266`*^9, 
  3.879850757690911*^9}},ExpressionUUID->"1b40e377-8145-49e4-9722-\
5fd7806509ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"R\[Phi]", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", " ", "0", ",", " ", "0"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", " ", 
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}], ",", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "}"}]}], "}"}]}], ";"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.879850776048605*^9, 3.879850881134076*^9}, {
  3.8798514902737865`*^9, 3.879851530785448*^9}},
 CellLabel->
  "In[1184]:=",ExpressionUUID->"a6b34a7e-5b30-4cec-8c00-84cf937624ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"R\[Theta]", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", " ", "0", ",", " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", " ", "0", ",", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8798508846708965`*^9, 3.8798509446180744`*^9}, 
   3.879851494721717*^9},
 CellLabel->
  "In[1185]:=",ExpressionUUID->"5f407e1e-63f4-4b91-92fe-3a0c89f8c866"],

Cell[BoxData[
 RowBox[{
  RowBox[{"R\[Psi]", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Psi]", "]"}], ",", " ", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}], ",", " ", "0"}], "}"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Psi]", "]"}], ",", " ", 
       RowBox[{"Cos", "[", "\[Psi]", "]"}], ",", " ", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", "1"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.879850948969607*^9, 3.8798510091441326`*^9}, 
   3.879851495755659*^9},
 CellLabel->
  "In[1186]:=",ExpressionUUID->"72c0bb4c-d5bf-4c57-8921-956fde044411"],

Cell["\<\
Now construct the rotation from the inertial frame (W) to the body frame (B). \
This is a ZYX rotation.\
\>", "Text",
 CellChangeTimes->{{3.8798510451915827`*^9, 3.87985106459192*^9}, {
  3.879851470618688*^9, 
  3.8798514771876173`*^9}},ExpressionUUID->"7aa606c7-9fb0-4879-8882-\
b7e6ac1a0c0d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"WRB", " ", "=", " ", 
   RowBox[{"R\[Psi]", ".", "R\[Theta]", ".", "R\[Phi]"}]}], ";", " ", 
  RowBox[{"MatrixForm", "[", "WRB", "]"}]}]], "Input",
 CellChangeTimes->{{3.879851068045746*^9, 3.8798510971901636`*^9}, {
  3.8798513644907084`*^9, 3.879851366313797*^9}, {3.879851553230034*^9, 
  3.8798515563904777`*^9}},
 CellLabel->
  "In[1187]:=",ExpressionUUID->"211378ba-28f4-4442-93c5-d306cf9931e1"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Psi]", "]"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}]},
     {
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Psi]", "]"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Psi]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", "\[Psi]", "]"}]}], " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}]},
     {
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}], 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.879851265526409*^9, {3.879851370709236*^9, 3.8798513871839247`*^9}, {
   3.8798515036829815`*^9, 3.879851563810241*^9}, 3.8798517070154796`*^9, 
   3.8798517397522182`*^9, 3.87985192985876*^9, {3.879851972890885*^9, 
   3.8798519841480055`*^9}, 3.879852064202566*^9, 3.8798521755646615`*^9, 
   3.879852263694666*^9, 3.879852336688283*^9, {3.8798528226651936`*^9, 
   3.8798528312135715`*^9}, 3.8798528952195992`*^9, 3.8798530645652704`*^9, 
   3.87985310303026*^9, 3.8799491089059577`*^9, 3.8799500899559793`*^9, {
   3.879950155464479*^9, 3.879950173384426*^9}, 3.879950403602248*^9, 
   3.8824445057967443`*^9, 3.8824445560570936`*^9, 3.8824448890852556`*^9, 
   3.882445152235898*^9, 3.8824458305302124`*^9, 3.8824459270924344`*^9, 
   3.88244598345916*^9, 3.882446021118829*^9, 3.8824461577666664`*^9, 
   3.8824461905010138`*^9, 3.882446259778926*^9, {3.8824463316767673`*^9, 
   3.8824463554498253`*^9}, 3.882446414889016*^9, {3.8824464558024645`*^9, 
   3.8824464790421224`*^9}, 3.882446516558939*^9, {3.8824465571391125`*^9, 
   3.882446700616638*^9}, {3.8824467346387396`*^9, 3.8824467517605066`*^9}, 
   3.88244679785913*^9, 3.8824481185673037`*^9, 3.8824482038836555`*^9, {
   3.882448252233214*^9, 3.8824484050780635`*^9}, {3.882448435774454*^9, 
   3.882448448511259*^9}, {3.882448483062111*^9, 3.882448544794905*^9}, {
   3.882448589020402*^9, 3.8824486233793225`*^9}, 3.8824486676480455`*^9, {
   3.882448703721716*^9, 3.8824487240633087`*^9}, {3.8824487555388594`*^9, 
   3.882448776598831*^9}, 3.882448911797472*^9, 3.8824494808086023`*^9, 
   3.882449773905016*^9, 3.9526808393077545`*^9, 3.9526809128921165`*^9, {
   3.9526809687794666`*^9, 3.9526809924975777`*^9}, 3.9526810403011665`*^9, 
   3.952681135303322*^9, 3.9526811697856426`*^9, 3.9526812316929874`*^9, 
   3.9723939553180237`*^9, {3.972395151242052*^9, 3.9723951869560776`*^9}, 
   3.9723954583860073`*^9, 3.9723956101865234`*^9, 3.9723958034442787`*^9, 
   3.9723958765642567`*^9, 3.972395972767191*^9, 3.972396055259697*^9},
 CellLabel->
  "Out[1187]//MatrixForm=",ExpressionUUID->"1dfc78c1-7370-9649-b28d-\
66b86b589b3a"]
}, Open  ]],

Cell["\<\
And get the inverse, which rotates a vector in the inertial frame (W) to the \
body frame (B)\
\>", "Text",
 CellChangeTimes->{{3.879851108930691*^9, 
  3.879851137740646*^9}},ExpressionUUID->"09bef602-76d5-4532-9588-\
28fec998a1d6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"BRW", " ", "=", " ", 
   RowBox[{"Transpose", "[", "WRB", "]"}]}], ";", " ", 
  RowBox[{"MatrixForm", "[", "BRW", "]"}]}]], "Input",
 CellChangeTimes->{{3.8798511126640415`*^9, 3.8798511256328645`*^9}, {
  3.8798515516120415`*^9, 3.8798515608935027`*^9}},
 CellLabel->
  "In[1188]:=",ExpressionUUID->"b5c78ce9-e402-4801-9128-e91ceebe6242"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Psi]", "]"}]}], 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Psi]", "]"}]}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Psi]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", "\[Psi]", "]"}]}], " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.879851387230928*^9, {3.8798515037379875`*^9, 3.879851563856249*^9}, 
   3.8798517070469933`*^9, 3.879851739787222*^9, 3.879851929896762*^9, {
   3.8798519729208856`*^9, 3.879851984185009*^9}, 3.8798520642435713`*^9, 
   3.8798521755991735`*^9, 3.8798522637306705`*^9, 3.879852336726472*^9, {
   3.879852822698196*^9, 3.8798528312445736`*^9}, 3.8798528952566013`*^9, 
   3.8798530646002755`*^9, 3.8798531030662637`*^9, 3.8799491089359612`*^9, 
   3.8799500899849815`*^9, {3.87995015549248*^9, 3.8799501734144278`*^9}, 
   3.8799504036302505`*^9, 3.8824445058597507`*^9, 3.882444556127098*^9, 
   3.8824448891492615`*^9, 3.8824451522939024`*^9, 3.882445830589213*^9, 
   3.8824459271514378`*^9, 3.8824459835161667`*^9, 3.882446021180834*^9, 
   3.882446157848671*^9, 3.882446190563019*^9, 3.8824462598409305`*^9, {
   3.8824463317377677`*^9, 3.8824463555098314`*^9}, 3.882446414941022*^9, {
   3.882446455883472*^9, 3.882446479097129*^9}, 3.8824465166099415`*^9, {
   3.8824465571801167`*^9, 3.8824467006976433`*^9}, {3.8824467347017446`*^9, 
   3.8824467518125086`*^9}, 3.8824467978981333`*^9, 3.8824481186333065`*^9, 
   3.882448203925663*^9, {3.8824482523042393`*^9, 3.8824484051372223`*^9}, {
   3.882448435830921*^9, 3.882448448570841*^9}, {3.8824484831171227`*^9, 
   3.8824485448553104`*^9}, {3.882448589087764*^9, 3.882448623438943*^9}, 
   3.8824486676996603`*^9, {3.8824487037876315`*^9, 3.8824487241342993`*^9}, {
   3.8824487556278515`*^9, 3.8824487766838393`*^9}, 3.8824489118608294`*^9, 
   3.882449480900608*^9, 3.882449774000022*^9, 3.952680839326044*^9, 
   3.9526809129016285`*^9, {3.9526809688431835`*^9, 3.9526809925712643`*^9}, 
   3.9526810403611393`*^9, 3.95268113531571*^9, 3.952681169855652*^9, 
   3.9526812317030373`*^9, 3.972393955327421*^9, {3.972395151246063*^9, 
   3.9723951869560776`*^9}, 3.9723954583860073`*^9, 3.972395610191063*^9, 
   3.97239580345446*^9, 3.972395876574072*^9, 3.97239597277367*^9, 
   3.9723960552657433`*^9},
 CellLabel->
  "Out[1188]//MatrixForm=",ExpressionUUID->"1bcf6ea0-c0ad-2744-91e8-\
a087b59b25b6"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Velocity (in both frames)", "Subsubsection",
 CellChangeTimes->{{3.866800511496004*^9, 3.8668005147314186`*^9}, {
  3.879848670508383*^9, 3.879848671565477*^9}, {3.972394835867199*^9, 
  3.972394836807228*^9}, {3.97239487381386*^9, 
  3.97239487523621*^9}},ExpressionUUID->"0fe80794-c1e9-41b8-95b6-\
9ce375e5a507"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Wvel", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"xdot", ",", " ", "ydot", ",", " ", "zdot"}], "}"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Bvel", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"Bxdot", ",", " ", "Bydot", ",", " ", "Bzdot"}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8667969811030474`*^9, 3.86679698621947*^9}, {
   3.866797021514927*^9, 3.8667970342690563`*^9}, {3.8798486740037355`*^9, 
   3.879848690655925*^9}, {3.879848938193113*^9, 3.879848938851866*^9}, {
   3.8798490169792223`*^9, 3.87984902284342*^9}, 3.8798516814888854`*^9, {
   3.972394864607708*^9, 3.9723948712875175`*^9}, {3.9723957527349873`*^9, 
   3.9723957896247063`*^9}},
 CellLabel->
  "In[1189]:=",ExpressionUUID->"47a92398-bfb3-485d-a72c-162cebfdc94e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalOmega]", "=", " ", 
    RowBox[{"{", 
     RowBox[{"p", ",", " ", "q", ",", " ", "r"}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "rates", " ", "expressed", " ", "in", " ", "the", " ", "Body", 
    " ", 
    RowBox[{"Frame", "!!"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.8667970428815236`*^9, 3.866797085921672*^9}, {
  3.866797870830329*^9, 3.866797873022787*^9}, {3.866800470988899*^9, 
  3.866800472069046*^9}, {3.8691405911532*^9, 3.86914060843052*^9}, {
  3.8798489478518105`*^9, 3.8798490142616606`*^9}, {3.8798502666862607`*^9, 
  3.87985027545543*^9}},
 CellLabel->
  "In[1191]:=",ExpressionUUID->"46d019b8-9126-421b-8eb1-7087ededb36d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wind Vector (in both frames)", "Subsubsection",
 CellChangeTimes->{{3.8798487579776807`*^9, 3.8798487775033083`*^9}, {
  3.9723947976414013`*^9, 3.972394802314152*^9}, {3.97239487666016*^9, 
  3.9723948781372166`*^9}},ExpressionUUID->"80259df8-0181-4c69-a5b5-\
95f1597000a1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Wwind", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"wx", ",", " ", "wy", ",", " ", "wz"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Bwind", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"Bwx", ",", " ", "Bwy", ",", " ", "Bwz"}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8798487634773912`*^9, 3.8798487700505953`*^9}, {
   3.879851669044634*^9, 3.879851677370758*^9}, 3.8798519250668573`*^9, {
   3.972394803417366*^9, 3.972394820227518*^9}, {3.9723957678953285`*^9, 
   3.97239578391485*^9}},
 CellLabel->
  "In[1192]:=",ExpressionUUID->"feb29a9e-3daa-4713-a8a0-f5af82387ceb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Motor Speeds", "Subsubsection",
 CellChangeTimes->{{3.879848790511197*^9, 3.8798487939354305`*^9}, {
  3.8798488304255705`*^9, 
  3.8798488385347996`*^9}},ExpressionUUID->"3c9fb6a6-91b5-4a93-9abe-\
56a833c10f34"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Eta]", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "\[Eta]1", ",", " ", "\[Eta]2", ",", " ", "\[Eta]3", ",", " ", 
     "\[Eta]4"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8798487963348145`*^9, 3.879848821096362*^9}, 
   3.8798519235191145`*^9},
 CellLabel->
  "In[1194]:=",ExpressionUUID->"5035a682-e4ad-45b5-838c-38c22e8a40b5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Control Forces and Moments", "Section",
 CellChangeTimes->{{3.8667980090418377`*^9, 3.866798011098448*^9}, {
  3.8798529867147913`*^9, 
  3.8798529927855883`*^9}},ExpressionUUID->"02e76445-37c5-41d0-a35a-\
f900f58483af"],

Cell[TextData[StyleBox["Commanded Motor Speeds", "Subsubsection"]], "Text",
 CellChangeTimes->{{3.866797173948002*^9, 3.8667971764227953`*^9}, {
  3.879848825047089*^9, 
  3.8798488436837006`*^9}},ExpressionUUID->"900b3d05-c12a-46a5-bd84-\
ca1d550ea726"],

Cell[BoxData[
 RowBox[{
  RowBox[{"u", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"u1", ",", " ", "u2", ",", " ", "u3", ",", " ", "u4"}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.866797163750186*^9, 3.8667971693859863`*^9}},
 CellLabel->
  "In[1195]:=",ExpressionUUID->"2debed46-d329-43bc-8fa5-accb614955ea"],

Cell[TextData[StyleBox["Rotor Thrusts", "Subsubsection"]], "Text",
 CellChangeTimes->{{3.866797485844082*^9, 
  3.8667975145931997`*^9}},ExpressionUUID->"bdac7858-1f67-473b-aa2d-\
45f8995568ec"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"thrusts", " ", "=", " ", 
  RowBox[{"k\[Eta]", " ", "*", " ", 
   RowBox[{"(", 
    RowBox[{"\[Eta]", "^", "2"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.866797494292898*^9, 3.866797534269407*^9}, {
  3.8667975934085245`*^9, 3.866797605807993*^9}, {3.8668178249844265`*^9, 
  3.866817825184242*^9}, {3.8691461112344985`*^9, 3.8691461236226315`*^9}, {
  3.8798488479661217`*^9, 3.8798488512663307`*^9}, {3.879849458098323*^9, 
  3.879849464788849*^9}, {3.879949745782142*^9, 3.8799497476610785`*^9}, {
  3.9526806300168686`*^9, 3.9526806448050785`*^9}},
 CellLabel->
  "In[1196]:=",ExpressionUUID->"9fb4bdb8-e2e4-4c99-93ea-ae8897439d5d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"k\[Eta]", " ", 
    SuperscriptBox["\[Eta]1", "2"]}], ",", 
   RowBox[{"k\[Eta]", " ", 
    SuperscriptBox["\[Eta]2", "2"]}], ",", 
   RowBox[{"k\[Eta]", " ", 
    SuperscriptBox["\[Eta]3", "2"]}], ",", 
   RowBox[{"k\[Eta]", " ", 
    SuperscriptBox["\[Eta]4", "2"]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8667975375586004`*^9, {3.8667976003398733`*^9, 3.866797608626215*^9}, {
   3.866797844333561*^9, 3.8667978658216395`*^9}, {3.8667997873104897`*^9, 
   3.8667998126920853`*^9}, 3.8667998542771025`*^9, 3.8667999017944994`*^9, 
   3.8667999624831376`*^9, 3.8667999956030617`*^9, 3.8668000586511183`*^9, {
   3.86680011779476*^9, 3.8668001553841105`*^9}, 3.8668002568082495`*^9, {
   3.866800348585197*^9, 3.8668003679613094`*^9}, {3.866800416021967*^9, 
   3.8668004406606417`*^9}, 3.8668025610585365`*^9, 3.8668025930395703`*^9, 
   3.866802691713887*^9, {3.866802764646216*^9, 3.8668027779546423`*^9}, 
   3.8668029260925255`*^9, {3.8668029648260126`*^9, 3.8668029927002764`*^9}, {
   3.8668031706967278`*^9, 3.866803185449809*^9}, {3.8668032636175585`*^9, 
   3.86680327349452*^9}, 3.8668033775076337`*^9, {3.8668035981705303`*^9, 
   3.8668036102249575`*^9}, 3.8668036548888845`*^9, 3.8668037535270185`*^9, 
   3.8668039091425543`*^9, {3.8668039690216594`*^9, 3.8668040406702185`*^9}, 
   3.866804224103588*^9, 3.866804519163491*^9, 3.866804697033025*^9, 
   3.8668049199762173`*^9, 3.8668069971476126`*^9, 3.866807168099005*^9, 
   3.866807301595665*^9, {3.8668073975692005`*^9, 3.8668074206620417`*^9}, {
   3.8668074643425803`*^9, 3.866807498999822*^9}, {3.8668075437337227`*^9, 
   3.866807577117118*^9}, 3.866807687908809*^9, {3.8668077462152967`*^9, 
   3.8668077673587117`*^9}, 3.8668078149385138`*^9, 3.866807867546191*^9, 
   3.8668079906983786`*^9, 3.8668080484872932`*^9, 3.8668081835107746`*^9, 
   3.866808415620582*^9, 3.8668157607592773`*^9, 3.8668158023100624`*^9, 
   3.8668158336762123`*^9, 3.8668158674039063`*^9, {3.8668159161693225`*^9, 
   3.866815971133748*^9}, 3.8668160087848167`*^9, {3.86681609519726*^9, 
   3.8668161074071703`*^9}, {3.8668161851098022`*^9, 3.866816217414385*^9}, {
   3.8668162911129694`*^9, 3.8668162971480427`*^9}, {3.866816391445868*^9, 
   3.866816470425374*^9}, 3.8668165398572035`*^9, {3.866816592813902*^9, 
   3.866816642857136*^9}, {3.866816680440344*^9, 3.866816720662736*^9}, {
   3.8668167573689194`*^9, 3.866816792444931*^9}, 3.8668168331062593`*^9, 
   3.866816900695504*^9, 3.8668169439417953`*^9, 3.866817047233903*^9, 
   3.866817326247504*^9, {3.8668173655566063`*^9, 3.8668173906506147`*^9}, 
   3.8668175274862156`*^9, 3.866817608683921*^9, {3.8668176419815392`*^9, 
   3.866817668620146*^9}, 3.86681775376784*^9, {3.866817826551055*^9, 
   3.866817846133031*^9}, 3.8668179678975077`*^9, {3.8668194666991367`*^9, 
   3.8668194908676815`*^9}, 3.866819551773415*^9, 3.866819626164305*^9, 
   3.866819732124777*^9, {3.866819763768531*^9, 3.8668197886065483`*^9}, 
   3.8668198526488647`*^9, {3.866819930122446*^9, 3.866819955726736*^9}, {
   3.866820077954757*^9, 3.866820096842379*^9}, 3.866820163224411*^9, {
   3.866820252370922*^9, 3.866820277460026*^9}, 3.86682075343309*^9, 
   3.866821043870467*^9, 3.866821082947836*^9, 3.8668212729170933`*^9, 
   3.8668214456895885`*^9, {3.8668216540828967`*^9, 3.8668217314850473`*^9}, 
   3.8668219540187054`*^9, 3.866822348485855*^9, 3.8668236464793177`*^9, 
   3.866823982042578*^9, 3.867411772545553*^9, 3.867412098157978*^9, {
   3.8674135063486004`*^9, 3.8674135265992875`*^9}, 3.8674136704532995`*^9, {
   3.8674143748963346`*^9, 3.8674143933109236`*^9}, 3.8674144948067217`*^9, 
   3.8674146167497606`*^9, 3.8674147428525906`*^9, {3.867414814391387*^9, 
   3.8674148819744425`*^9}, 3.8674149138316517`*^9, 3.867414966821803*^9, 
   3.8674156134374804`*^9, 3.8674156661545734`*^9, 3.8674157164483576`*^9, {
   3.8674157505592117`*^9, 3.867415784499902*^9}, 3.8674158203464866`*^9, 
   3.8674159387480297`*^9, 3.8674160750225697`*^9, 3.8674161904255495`*^9, 
   3.8674163075416555`*^9, 3.867416363426098*^9, 3.8674171028386383`*^9, 
   3.86741715571157*^9, 3.8674172555994344`*^9, 3.8677696187089653`*^9, 
   3.8677699932023787`*^9, 3.8677701153027782`*^9, 3.867772090887061*^9, 
   3.8677724727928905`*^9, 3.867844470860881*^9, 3.8678445757432384`*^9, 
   3.8678448261294136`*^9, 3.8678448721371584`*^9, 3.867844918151658*^9, 
   3.86784513367774*^9, 3.867845173557334*^9, 3.8678453083338995`*^9, 
   3.8678453953560276`*^9, 3.867845565141632*^9, 3.8678466154603977`*^9, {
   3.8678477690110035`*^9, 3.867847781963396*^9}, 3.8678479060845385`*^9, 
   3.867847951868224*^9, 3.8678495496274385`*^9, 3.8679429331366725`*^9, 
   3.8679430171613865`*^9, 3.8691399433378825`*^9, {3.869140043343069*^9, 
   3.8691400531712704`*^9}, {3.86914010164797*^9, 3.8691401246709375`*^9}, 
   3.8691417589250517`*^9, 3.8691417965720344`*^9, 3.869141929527388*^9, 
   3.869142076684473*^9, 3.869142487449385*^9, 3.8691458420250177`*^9, 
   3.869146159761339*^9, 3.86914631986917*^9, 3.8691464397116895`*^9, 
   3.8691466199708157`*^9, 3.869146687025817*^9, {3.8691474279460444`*^9, 
   3.8691474492702603`*^9}, {3.8691474816946597`*^9, 3.8691474914945436`*^9}, 
   3.869147522504874*^9, {3.8691475677847977`*^9, 3.8691475763143363`*^9}, 
   3.8691476484046125`*^9, 3.8691476786669073`*^9, {3.869148821726493*^9, 
   3.8691488424476376`*^9}, 3.8691490147562475`*^9, {3.869149621064171*^9, 
   3.869149688660541*^9}, 3.8691498935156317`*^9, {3.8691499286771994`*^9, 
   3.869149968351224*^9}, 3.8691499988595552`*^9, 3.869150655337412*^9, 
   3.8691508917651024`*^9, 3.869151091230934*^9, {3.8691512062862988`*^9, 
   3.8691512241264887`*^9}, {3.8691515570162597`*^9, 3.869151607098703*^9}, 
   3.869151662055669*^9, {3.869151716581129*^9, 3.869151744724202*^9}, 
   3.869222829734763*^9, 3.869223100086948*^9, 3.8692232420597525`*^9, 
   3.8692281089775295`*^9, 3.869229721767617*^9, 3.8692350782348337`*^9, 
   3.869304425939434*^9, 3.869304557888757*^9, 3.8693060046813154`*^9, 
   3.8698437517967305`*^9, 3.869845154682828*^9, 3.869845370429052*^9, {
   3.8704265725314217`*^9, 3.8704265980936966`*^9}, 3.870427078288604*^9, 
   3.8704276201761804`*^9, 3.879851265624421*^9, {3.879851370900257*^9, 
   3.8798513874589453`*^9}, {3.879851503892053*^9, 3.879851563996393*^9}, 
   3.8798517071510043`*^9, 3.8798517399032297`*^9, 3.879851929997466*^9, {
   3.8798519729678955`*^9, 3.879851984228424*^9}, 3.8798520642935743`*^9, 
   3.879852175649184*^9, 3.8798522637707167`*^9, 3.879852336781477*^9, {
   3.8798528227462063`*^9, 3.8798528312926965`*^9}, 3.8798528953026056`*^9, 
   3.879853064645379*^9, 3.8798531031097803`*^9, 3.8799491089779625`*^9, 
   3.8799500900219836`*^9, {3.8799501555264845`*^9, 3.8799501734614305`*^9}, 
   3.8799504036702538`*^9, 3.882444506027763*^9, 3.882444556215103*^9, 
   3.882444889236272*^9, 3.8824451523779097`*^9, 3.8824458306602182`*^9, 
   3.8824459272294445`*^9, 3.88244598358817*^9, 3.882446021257841*^9, 
   3.882446157941676*^9, 3.882446190637025*^9, 3.8824462599169345`*^9, {
   3.882446331813098*^9, 3.882446355594838*^9}, 3.882446415007025*^9, {
   3.8824464559804764`*^9, 3.8824464791601315`*^9}, 3.882446516679948*^9, {
   3.8824465572251177`*^9, 3.882446700782874*^9}, {3.882446734791971*^9, 
   3.8824467518805146`*^9}, 3.8824467979609237`*^9, 3.8824481187113123`*^9, 
   3.8824482039736423`*^9, {3.8824482523979206`*^9, 3.882448405214631*^9}, {
   3.8824484359023046`*^9, 3.8824484486438737`*^9}, {3.8824484831988487`*^9, 
   3.882448544933312*^9}, {3.882448589151768*^9, 3.8824486235139236`*^9}, 
   3.882448667768505*^9, {3.8824487038446355`*^9, 3.882448724235751*^9}, {
   3.8824487557055864`*^9, 3.882448776780568*^9}, 3.882448911937834*^9, 
   3.8824494810206184`*^9, 3.882449774121031*^9, 3.9526808393627796`*^9, 
   3.9526809129221916`*^9, {3.952680969037319*^9, 3.9526809927315807`*^9}, 
   3.952681040590187*^9, 3.9526811353531227`*^9, 3.952681170046028*^9, 
   3.952681231724592*^9, 3.9723939553579655`*^9, {3.972395151261875*^9, 
   3.972395186975994*^9}, 3.972395458405815*^9, 3.972395610208666*^9, 
   3.9723958034661713`*^9, 3.972395876585703*^9, 3.9723959727937756`*^9, 
   3.972396055282486*^9},
 CellLabel->
  "Out[1196]=",ExpressionUUID->"b5596442-7018-d443-9306-21e6424abbd0"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BTR1", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{"thrusts", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "These", " ", "are", " ", "the", " ", "individual", " ", "thrust", " ", 
    "vectors", " ", "in", " ", "the", " ", "body", " ", "frame", " ", 
    "coordinates"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BTR2", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"thrusts", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BTR3", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"thrusts", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BTR4", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"thrusts", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.869222671003298*^9, 3.869222737923009*^9}},
 CellLabel->
  "In[1197]:=",ExpressionUUID->"cb6484dc-8ed7-4eb9-8323-d35c9daac72c"],

Cell[TextData[StyleBox["Rotor Yaw Moments", "Subsubsection"]], "Text",
 CellChangeTimes->{{3.8667977302124753`*^9, 3.866797738113968*^9}, {
  3.8798530049511576`*^9, 
  3.879853006384549*^9}},ExpressionUUID->"3fafea38-8e03-4cae-9d86-\
048f72d1552f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dragmoment", " ", "=", " ", 
  RowBox[{"\[Epsilon]", " ", "*", " ", "km", " ", "*", " ", 
   RowBox[{"(", 
    RowBox[{"\[Eta]", "^", "2"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.8667977415205345`*^9, 3.8667977533426332`*^9}, {
  3.866799947912015*^9, 3.866799957382131*^9}, {3.866817814078049*^9, 
  3.866817816304324*^9}, {3.8691462528984966`*^9, 3.8691463125694447`*^9}, {
  3.869146371455901*^9, 3.869146376143403*^9}, {3.869146597946056*^9, 
  3.8691465983847704`*^9}, {3.879849432942058*^9, 3.879849434956952*^9}, {
  3.8799497516249065`*^9, 3.8799497530485797`*^9}},
 CellLabel->
  "In[1201]:=",ExpressionUUID->"1d677b38-e809-4c9c-b266-66569e9079f6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"km", " ", 
    SuperscriptBox["\[Eta]1", "2"]}], ",", 
   RowBox[{
    RowBox[{"-", "km"}], " ", 
    SuperscriptBox["\[Eta]2", "2"]}], ",", 
   RowBox[{"km", " ", 
    SuperscriptBox["\[Eta]3", "2"]}], ",", 
   RowBox[{
    RowBox[{"-", "km"}], " ", 
    SuperscriptBox["\[Eta]4", "2"]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8691466199818172`*^9, 3.869146687075818*^9, {3.8691474279870453`*^9, 
   3.8691474493062615`*^9}, {3.869147481732662*^9, 3.8691474915365505`*^9}, 
   3.8691475225488777`*^9, {3.8691475678248005`*^9, 3.869147576353341*^9}, 
   3.8691476484536185`*^9, 3.869147678706912*^9, {3.869148821821497*^9, 
   3.8691488425186453`*^9}, 3.869149014857257*^9, {3.8691496211431766`*^9, 
   3.869149688737548*^9}, 3.869149893592637*^9, {3.8691499287512083`*^9, 
   3.8691499684022245`*^9}, 3.8691499989395604`*^9, 3.869150655412423*^9, 
   3.8691508918091063`*^9, 3.8691510913109417`*^9, {3.8691512063683033`*^9, 
   3.8691512242064943`*^9}, {3.8691515570892673`*^9, 3.869151607150707*^9}, 
   3.869151662103673*^9, {3.8691517166583433`*^9, 3.8691517447982097`*^9}, 
   3.8692228298715963`*^9, 3.869223100199563*^9, 3.869223242186473*^9, 
   3.8692281091382217`*^9, 3.8692297219512644`*^9, 3.8692350783718443`*^9, 
   3.8693044260664415`*^9, 3.8693045580544415`*^9, 3.869306004819799*^9, 
   3.869843751946076*^9, 3.869845154808838*^9, 3.869845370504041*^9, {
   3.8704265726414332`*^9, 3.870426598153703*^9}, 3.8704270784116106`*^9, 
   3.8704276203001385`*^9, 3.879851265680425*^9, {3.8798513709991693`*^9, 
   3.8798513875272064`*^9}, {3.879851503952882*^9, 3.879851564084399*^9}, 
   3.879851707220456*^9, 3.8798517399792366`*^9, 3.879851930082467*^9, {
   3.8798519730332975`*^9, 3.879851984278432*^9}, 3.879852064363582*^9, 
   3.879852175717188*^9, 3.8798522638437614`*^9, 3.879852336861481*^9, {
   3.8798528228132067`*^9, 3.8798528313587008`*^9}, 3.8798528953406096`*^9, 
   3.8798530646813817`*^9, 3.879853103144783*^9, 3.8799491090109653`*^9, 
   3.87995009005419*^9, {3.879950155554484*^9, 3.879950173495433*^9}, 
   3.879950403702256*^9, 3.8824445060897675`*^9, 3.88244455629011*^9, 
   3.882444889304272*^9, 3.8824451524399137`*^9, 3.882445830717222*^9, 
   3.8824459272834473`*^9, 3.882445983643173*^9, 3.8824460213208447`*^9, 
   3.8824461580136886`*^9, 3.8824461906980286`*^9, 3.8824462599639378`*^9, {
   3.8824463318731003`*^9, 3.8824463556748443`*^9}, 3.882446415055028*^9, {
   3.882446456057482*^9, 3.882446479233138*^9}, 3.882446516747202*^9, {
   3.88244655725712*^9, 3.8824467008588743`*^9}, {3.8824467348619785`*^9, 
   3.8824467519265194`*^9}, 3.8824467980269217`*^9, 3.8824481187787447`*^9, 
   3.8824482040126467`*^9, {3.88244825245792*^9, 3.8824484052596345`*^9}, {
   3.88244843596431*^9, 3.8824484487008715`*^9}, {3.8824484832618527`*^9, 
   3.8824485449972987`*^9}, {3.8824485891917696`*^9, 3.8824486235714245`*^9}, 
   3.8824486678257103`*^9, {3.88244870390661*^9, 3.882448724313756*^9}, {
   3.8824487557923946`*^9, 3.882448776855572*^9}, 3.88244891199479*^9, 
   3.8824494811326284`*^9, 3.8824497742130394`*^9, 3.9526808393792534`*^9, 
   3.952680912934536*^9, {3.952680969156931*^9, 3.952680992807213*^9}, 
   3.9526810406593475`*^9, 3.9526811353730392`*^9, 3.9526811701173*^9, 
   3.952681231732689*^9, 3.972393955387842*^9, {3.9723951512729225`*^9, 
   3.9723951869859962`*^9}, 3.972395458411087*^9, 3.9723956102149544`*^9, 
   3.972395803472193*^9, 3.9723958765980186`*^9, 3.972395972818033*^9, 
   3.9723960552889977`*^9},
 CellLabel->
  "Out[1201]=",ExpressionUUID->"05faabb7-245a-e14d-acf6-798d82dbdbdd"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ByawmomentR1", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{"dragmoment", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "These", " ", "are", " ", "the", " ", "drag", " ", "moments", " ", "in", " ",
     "the", " ", "body", " ", "frame", " ", "coordinates"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ByawmomentR2", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"dragmoment", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ByawmomentR3", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"dragmoment", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ByawmomentR4", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"dragmoment", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8692228573222246`*^9, 3.8692229478813667`*^9}, {
  3.8798496826796417`*^9, 3.879849690961646*^9}},
 CellLabel->
  "In[1202]:=",ExpressionUUID->"56218400-9327-4db2-a790-4f58861ca6ea"],

Cell[CellGroupData[{

Cell["Control Wrench", "Subsubsection",
 CellChangeTimes->{{3.8667997102805634`*^9, 3.866799720245285*^9}, {
  3.8824437843694224`*^9, 3.882443803784251*^9}, {3.8824438985313144`*^9, 
  3.882443900793391*^9}},ExpressionUUID->"f5c24af9-0233-4699-a59c-\
ea15749c53ba"],

Cell["\<\
The total moments cause by each rotor is the drag moment + the moment arm\
\>", "Text",
 CellChangeTimes->{{3.8668232912969155`*^9, 
  3.866823296266345*^9}},ExpressionUUID->"6b1e8b0c-d7fd-4c64-9fce-\
16ee2496492a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BcontrolmomentR1", " ", "=", " ", 
   RowBox[{
    RowBox[{"BpBR1", " ", "\[Cross]", " ", "BTR1"}], "+", " ", 
    "ByawmomentR1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BcontrolmomentR2", " ", "=", " ", 
   RowBox[{
    RowBox[{"BpBR2", " ", "\[Cross]", " ", "BTR2"}], "+", " ", 
    "ByawmomentR2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BcontrolmomentR3", " ", "=", " ", 
   RowBox[{
    RowBox[{"BpBR3", " ", "\[Cross]", " ", "BTR3"}], "+", " ", 
    "ByawmomentR3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BcontrolmomentR4", " ", "=", " ", 
    RowBox[{
     RowBox[{"BpBR4", " ", "\[Cross]", " ", "BTR4"}], "+", " ", 
     "ByawmomentR4"}]}], ";"}], " "}]}], "Input",
 CellChangeTimes->{{3.866799728655409*^9, 3.8667998089490786`*^9}, {
   3.866799849032505*^9, 3.8667998908654485`*^9}, {3.8667999223934555`*^9, 
   3.86679993459886*^9}, {3.8667999667745843`*^9, 3.8667999921974707`*^9}, {
   3.866800033966363*^9, 3.866800034976066*^9}, {3.86914049676338*^9, 
   3.869140499471343*^9}, {3.8691415722764626`*^9, 3.869141586805465*^9}, {
   3.869146225741788*^9, 3.869146241955828*^9}, {3.8691463331289635`*^9, 
   3.8691464349937525`*^9}, {3.869146514397382*^9, 3.869146542819201*^9}, 
   3.869146684212254*^9, {3.8692228032341757`*^9, 3.8692228269838295`*^9}, {
   3.8692230771442165`*^9, 3.8692230968301272`*^9}, {3.869304542329279*^9, 
   3.8693045523416433`*^9}, {3.879849606423941*^9, 3.879849670983408*^9}, {
   3.879849711089237*^9, 3.87984971206758*^9}, {3.879853046059342*^9, 
   3.8798530579974966`*^9}, {3.8798530896117125`*^9, 
   3.8798530900745916`*^9}, {3.8824463205229487`*^9, 
   3.8824463634936876`*^9}, {3.8824464706720505`*^9, 3.882446474504425*^9}, {
   3.8824465047816715`*^9, 3.8824465226226797`*^9}},
 CellLabel->
  "In[1206]:=",ExpressionUUID->"c60cc8da-a51a-4048-b82e-cf50a9c44b5f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Btotcontrolmoment", " ", "=", " ", 
    RowBox[{
    "BcontrolmomentR1", " ", "+", " ", "BcontrolmomentR2", " ", "+", " ", 
     "BcontrolmomentR3", " ", "+", " ", "BcontrolmomentR4"}]}], " ", ";"}], 
  " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "is", " ", "the", " ", "total", " ", "moment", " ", 
    "expressed", " ", "in", " ", "the", " ", "body", " ", 
    RowBox[{"frame", "!"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Btotcontrolforce", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"Total", "[", "thrusts", "]"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.866800036605674*^9, 3.866800054927024*^9}, {
   3.8691405005399446`*^9, 3.8691405277368965`*^9}, 3.8691413181868253`*^9, {
   3.869141589548112*^9, 3.869141598889102*^9}, {3.869146557109086*^9, 
   3.869146575227504*^9}, 3.8691466166232615`*^9, 3.8691466819922*^9, {
   3.8798497163488655`*^9, 3.8798497309332094`*^9}, {3.879852881151329*^9, 
   3.879852892515399*^9}, {3.882446544586791*^9, 3.8824465638659487`*^9}},
 CellLabel->
  "In[1210]:=",ExpressionUUID->"083a16f6-c4bc-4c2e-82a9-a78006d3efde"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Aerodynamic Forces and Moments", "Section",
 CellChangeTimes->{{3.8798495426414995`*^9, 3.879849550232543*^9}, {
  3.879852978744002*^9, 
  3.879852981034753*^9}},ExpressionUUID->"ffea0472-0335-4dae-b598-\
e7183b83a18d"],

Cell["\<\
Aerodynamic forces consist of rotor drag, loss of thrust due to inflow, and \
parasitic (frame) drag. These are all defined in the body frame. Note that we \
are assuming that each propulsive unit sees the same airspeed (i.e. small \
body rates) and that they have the same describing coefficients (rotor drag, \
blade flapping, etc.). This enables us to compute the rotor drag faster. \
\>", "Text",
 CellChangeTimes->{{3.8798495539954233`*^9, 3.8798495800960474`*^9}, {
  3.879849764490447*^9, 3.8798497684964685`*^9}, {3.8798522862530384`*^9, 
  3.879852330159949*^9}},ExpressionUUID->"dc464bce-8aa4-4887-bac5-\
c4d5fe9f9451"],

Cell[CellGroupData[{

Cell["Airspeed Calculation", "Subsubsection",
 CellChangeTimes->{{3.879849744856303*^9, 
  3.8798497558686085`*^9}},ExpressionUUID->"ef8fe934-3d25-4d09-ab80-\
cc6d3ea4dba6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Wva", " ", "=", " ", 
   RowBox[{"Wvel", " ", "-", " ", "Wwind"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Bva", " ", "=", " ", 
   RowBox[{"Bvel", " ", "-", " ", "Bwind"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"airspeed", " ", "=", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Bva", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], " ", "+", " ", 
       RowBox[{
        RowBox[{"Bva", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], " ", "+", " ", 
       RowBox[{
        RowBox[{"Bva", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "^", "2"}]}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}]}]}], ";"}], "  "}], "\[IndentingNewLine]", 
 RowBox[{"vh2", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Bva", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], " ", "+", " ", 
   RowBox[{
    RowBox[{"Bva", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}]}]}], "Input",
 CellChangeTimes->{{3.879851652077063*^9, 3.8798517575172763`*^9}, {
  3.8824484130378585`*^9, 3.882448645568488*^9}, {3.952680743452883*^9, 
  3.9526807599578934`*^9}, {3.9723960404207706`*^9, 3.9723960435852604`*^9}},
 CellLabel->
  "In[1212]:=",ExpressionUUID->"fa71a186-eb92-45ac-9e7d-06a55c9ea7fd"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "Bwx"}], "+", "Bxdot"}], ")"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "Bwy"}], "+", "Bydot"}], ")"}], "2"]}]], "Output",
 CellChangeTimes->{
  3.952680839407612*^9, 3.9526809129643593`*^9, {3.9526809693602295`*^9, 
   3.9526809929573326`*^9}, 3.952681040840084*^9, 3.9526811354053097`*^9, 
   3.9526811703771687`*^9, 3.952681231754196*^9, 3.9723939554488487`*^9, {
   3.972395151286175*^9, 3.9723951870059624`*^9}, 3.9723954584258194`*^9, 
   3.972395610227352*^9, 3.972395803484701*^9, 3.972395876604248*^9, 
   3.9723959728238697`*^9, 3.9723960553005524`*^9},
 CellLabel->
  "Out[1215]=",ExpressionUUID->"8e6e6818-356c-8648-9fc6-e93ed6f02929"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rotor Drag ", "Subsubsection",
 CellChangeTimes->{{3.8798517802420454`*^9, 
  3.879851798414332*^9}},ExpressionUUID->"d9bfeb6e-f53a-47b2-819a-\
a24fdbc747f4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BrotordragR1", " ", "=", " ", 
   RowBox[{
    RowBox[{"-", "\[Eta]1"}], "*", 
    RowBox[{
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"{", 
       RowBox[{"kd", ",", " ", "kd", ",", " ", "kz"}], "}"}], "]"}], ".", 
     "Bva"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BrotordragR2", " ", "=", " ", 
   RowBox[{
    RowBox[{"-", "\[Eta]2"}], "*", 
    RowBox[{
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"{", 
       RowBox[{"kd", ",", " ", "kd", ",", " ", "kz"}], "}"}], "]"}], ".", 
     "Bva"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BrotordragR3", " ", "=", " ", 
   RowBox[{
    RowBox[{"-", "\[Eta]3"}], "*", 
    RowBox[{
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"{", 
       RowBox[{"kd", ",", " ", "kd", ",", " ", "kz"}], "}"}], "]"}], ".", 
     "Bva"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BrotordragR4", " ", "=", " ", 
   RowBox[{
    RowBox[{"-", "\[Eta]4"}], "*", 
    RowBox[{
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"{", 
       RowBox[{"kd", ",", " ", "kd", ",", " ", "kz"}], "}"}], "]"}], ".", 
     "Bva"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.879852527906335*^9, 3.8798526184337845`*^9}},
 CellLabel->
  "In[1216]:=",ExpressionUUID->"d431cc90-d1b9-4b78-b402-64eeba8db894"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BH", " ", "=", " ", 
   RowBox[{
   "BrotordragR1", " ", "+", " ", "BrotordragR2", " ", "+", " ", 
    "BrotordragR3", " ", "+", " ", "BrotordragR4"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.879851896642864*^9, 3.8798519802512045`*^9}, {
   3.8798525804748545`*^9, 3.879852593731391*^9}, 3.8798528275875854`*^9, {
   3.8824481340356226`*^9, 3.882448134602332*^9}},
 CellLabel->
  "In[1220]:=",ExpressionUUID->"ef49e383-7ab7-4160-875d-7d5652688f19"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moment Due to Rotor Drag", "Subsubsection",
 CellChangeTimes->{{3.8798524920744486`*^9, 
  3.879852498475691*^9}},ExpressionUUID->"5b7f3476-da82-4c4b-9eda-\
b767ec01c30c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BrotordragmomentR1", " ", "=", " ", 
   RowBox[{"BpBR1", " ", "\[Cross]", " ", "BrotordragR1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BrotordragmomentR2", " ", "=", " ", 
   RowBox[{"BpBR2", " ", "\[Cross]", " ", "BrotordragR2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BrotordragmomentR3", " ", "=", " ", 
   RowBox[{"BpBR3", " ", "\[Cross]", " ", "BrotordragR3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BrotordragmomentR4", " ", "=", " ", 
    RowBox[{"BpBR4", " ", "\[Cross]", " ", "BrotordragR4"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Btotrotordragmoment", " ", "=", " ", 
    RowBox[{
    "BrotordragmomentR1", " ", "+", " ", "BrotordragmomentR2", " ", "+", " ", 
     "BrotordragmomentR3", " ", "+", " ", "BrotordragmomentR4"}]}], ";"}], 
  " "}]}], "Input",
 CellChangeTimes->{{3.8798525018854413`*^9, 3.879852511476136*^9}, {
  3.8798526467821217`*^9, 3.879852784484623*^9}},
 CellLabel->
  "In[1221]:=",ExpressionUUID->"e2c5c934-acca-46f6-98b4-dda8ba5f36de"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Translational Lift", "Subsubsection",
 CellChangeTimes->{{3.9526806677151966`*^9, 
  3.952680670153179*^9}},ExpressionUUID->"2e305805-57fe-8945-9af2-\
cd62adf7ae52"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BTL", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", " ", "0", ",", " ", 
     RowBox[{"4", "*", "kh", "*", "vh2"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9526806781292953`*^9, 3.952680735170923*^9}, {
  3.9526807671839256`*^9, 3.9526807727688885`*^9}},
 CellLabel->
  "In[1226]:=",ExpressionUUID->"d3f2157e-75d5-e74a-94ff-61f720774def"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Total Aerodynamic Wrench", "Subsubsection",
 CellChangeTimes->{{3.8798523543937607`*^9, 3.879852354715873*^9}, {
  3.8798528402749023`*^9, 
  3.8798528427395554`*^9}},ExpressionUUID->"60146557-caa5-47fb-8c5f-\
6a8a0b569f91"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Btotaeroforce", " ", "=", " ", 
   RowBox[{"BH", " ", "+", " ", "BTL"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Btotaeromoment", " ", "=", " ", "Btotrotordragmoment"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8798523567487803`*^9, 3.8798523615787635`*^9}, {
  3.8798524561061754`*^9, 3.879852481578102*^9}, {3.879852801030078*^9, 
  3.879852811797693*^9}, {3.8824483117382584`*^9, 3.882448334763854*^9}, {
  3.972393728397215*^9, 3.9723937469336777`*^9}},
 CellLabel->
  "In[1227]:=",ExpressionUUID->"4d583a60-bad8-44ae-943d-8edb4b19bacd"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Total Forces and Moments", "Section",
 CellChangeTimes->{{3.8799489045501113`*^9, 
  3.8799489074868717`*^9}},ExpressionUUID->"a892f4e5-65ef-407d-80c3-\
9f605d461e7e"],

Cell["Compute the total forces and moments in the body frame", "Text",
 CellChangeTimes->{{3.8799489112419767`*^9, 3.8799489218720336`*^9}, {
  3.9723947681776237`*^9, 
  3.972394773037651*^9}},ExpressionUUID->"a4dfecac-9b88-41cb-aa84-\
99b3809ca1ad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Btotforce", " ", "=", " ", 
   RowBox[{"Btotcontrolforce", " ", "+", " ", "Btotaeroforce"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Wtotforce", " ", "=", " ", 
   RowBox[{"WRB", ".", "Btotforce"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8799489855773168`*^9, 3.8799490091443214`*^9}, {
  3.879949072083663*^9, 3.879949081451168*^9}, {3.8824482806738105`*^9, 
  3.8824483048341303`*^9}},
 CellLabel->
  "In[1229]:=",ExpressionUUID->"6b77ca35-18dd-436f-a1b7-0d4b60e51ce7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Btotmoment", " ", "=", " ", 
   RowBox[{"Btotcontrolmoment", " ", "+", " ", "Btotaeromoment"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8799490839160757`*^9, 3.8799490970828094`*^9}},
 CellLabel->
  "In[1231]:=",ExpressionUUID->"cabc6d91-238e-4196-85d3-927f77ac054e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Filter States", "Section",
 CellChangeTimes->{{3.866802833207575*^9, 
  3.8668028366142235`*^9}},ExpressionUUID->"fa8abb0a-823c-4740-b8ef-\
d0ba6bc9f211"],

Cell[BoxData[
 RowBox[{
  RowBox[{"constants", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "k\[Eta]", ",", " ", "km", ",", " ", "kd", ",", " ", "kz", ",", " ", 
     "kflap", ",", " ", "\[Tau]m"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.882445108050889*^9, 3.882445147846292*^9}},
 CellLabel->
  "In[1232]:=",ExpressionUUID->"e21a0260-3dca-4199-a576-b437d858791b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"x", " ", "=", " ", 
  RowBox[{"Join", "[", 
   RowBox[{
   "Bvel", ",", "\[CapitalTheta]", ",", " ", "\[CapitalOmega]", ",", " ", 
    "\[Eta]", ",", " ", "Bwind"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.866819460980609*^9, 3.866819500565423*^9}, {
   3.8668197492124352`*^9, 3.8668197497570252`*^9}, {3.866819816815658*^9, 
   3.8668198266840515`*^9}, {3.8668199232089186`*^9, 
   3.8668199521817303`*^9}, {3.866820073621677*^9, 3.866820093091922*^9}, {
   3.8668203917956915`*^9, 3.86682041645693*^9}, {3.866821399243313*^9, 
   3.866821422578535*^9}, {3.8668217239028673`*^9, 3.866821726483199*^9}, {
   3.866821947893965*^9, 3.866821951149111*^9}, 3.8668236096001396`*^9, {
   3.867412026072151*^9, 3.867412026548195*^9}, {3.8674136605797377`*^9, 
   3.8674136620498605`*^9}, {3.8674143398043933`*^9, 
   3.8674143401709805`*^9}, {3.86776947334107*^9, 3.8677694865494323`*^9}, {
   3.867770093651794*^9, 3.8677701074514246`*^9}, {3.867772056081558*^9, 
   3.8677720849627523`*^9}, {3.867844369664525*^9, 3.8678444469590826`*^9}, {
   3.86784481076713*^9, 3.867844819835993*^9}, {3.8678455584411435`*^9, 
   3.8678455586884794`*^9}, {3.867846592937416*^9, 3.867846596580394*^9}, {
   3.8678477525964127`*^9, 3.867847753998971*^9}, {3.8678478964809847`*^9, 
   3.867847902240136*^9}, {3.8678495380975275`*^9, 3.8678495415426893`*^9}, {
   3.8691405392475843`*^9, 3.869140547264118*^9}, {3.8691413466819863`*^9, 
   3.869141356552808*^9}, 3.869141426143536*^9, {3.869147364173153*^9, 
   3.8691473661128597`*^9}, {3.869147518100051*^9, 3.869147519356722*^9}, {
   3.8691475551058006`*^9, 3.8691475949943113`*^9}, {3.8691496151898303`*^9, 
   3.8691496864812613`*^9}, {3.8691498768239255`*^9, 3.869149996566456*^9}, {
   3.869150652651568*^9, 3.869150652913657*^9}, {3.8691508877023525`*^9, 
   3.869150887933854*^9}, {3.869151029572152*^9, 3.869151059851341*^9}, {
   3.8691512014564047`*^9, 3.869151203306134*^9}, {3.8691515524636917`*^9, 
   3.8691515533904896`*^9}, {3.8691516036936493`*^9, 3.869151603965683*^9}, 
   3.8691516597587214`*^9, {3.8691516983336897`*^9, 3.8691517424318943`*^9}, {
   3.869843726345913*^9, 3.8698437276869707`*^9}, {3.869845144507677*^9, 
   3.869845144992691*^9}, {3.8698453623708515`*^9, 3.8698453858837843`*^9}, {
   3.870426655146858*^9, 3.870426655477884*^9}, {3.8799491776868234`*^9, 
   3.879949178567455*^9}, {3.8799492135455303`*^9, 3.8799492240027337`*^9}, {
   3.879949291368289*^9, 3.879949363787179*^9}, 3.8799502852776985`*^9, {
   3.8799503942184095`*^9, 3.8799503965425687`*^9}, {3.8824439325587955`*^9, 
   3.882443932729808*^9}, 3.8824440136608453`*^9, {3.882444056201903*^9, 
   3.8824440742568245`*^9}, {3.8824441173848505`*^9, 3.882444120850608*^9}, {
   3.88244514335371*^9, 3.8824451449720173`*^9}, {3.952680091739483*^9, 
   3.9526801060283527`*^9}, {3.952680264224745*^9, 3.9526802657466087`*^9}, {
   3.9526809522243004`*^9, 3.9526809526375885`*^9}, {3.9526811144130325`*^9, 
   3.952681123767044*^9}, {3.9526811602979965`*^9, 3.952681162062937*^9}, 
   3.9526812208303623`*^9, {3.972393778459448*^9, 3.9723937793804264`*^9}, {
   3.972394947801777*^9, 3.9723949509408455`*^9}, {3.9723956029954605`*^9, 
   3.972395605112385*^9}, {3.972395851564451*^9, 3.9723958558843384`*^9}, {
   3.972396014874197*^9, 3.972396020517742*^9}},
 CellLabel->
  "In[1233]:=",ExpressionUUID->"7d072adf-663b-4710-a241-f0573464aa54"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "Bxdot", ",", "Bydot", ",", "Bzdot", ",", "\[Phi]", ",", "\[Theta]", ",", 
   "\[Psi]", ",", "p", ",", "q", ",", "r", ",", "\[Eta]1", ",", "\[Eta]2", ",",
    "\[Eta]3", ",", "\[Eta]4", ",", "Bwx", ",", "Bwy", ",", "Bwz"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.95268123180591*^9, 3.9723939555777187`*^9, {3.9723951513822384`*^9, 
   3.972395187025963*^9}, 3.972395458496046*^9, 3.9723956102511196`*^9, 
   3.972395803564413*^9, 3.9723958766800632`*^9, 3.9723959729139633`*^9, 
   3.972396055320614*^9},
 CellLabel->
  "Out[1233]=",ExpressionUUID->"265b9047-4a32-8f4b-8295-a970052ca432"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9526809481404057`*^9, 3.952680949830597*^9}, {
  3.9526812158058853`*^9, 3.952681224205982*^9}},
 CellLabel->
  "In[1234]:=",ExpressionUUID->"31165ca4-4b7a-724e-9a5b-2c22edfe5e29"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"n", " ", "=", " ", 
  RowBox[{"Length", "[", "x", "]"}]}]], "Input",
 CellChangeTimes->{{3.8668044564468994`*^9, 3.866804459852088*^9}, {
  3.879949366882517*^9, 3.8799493714227695`*^9}},
 CellLabel->
  "In[1235]:=",ExpressionUUID->"2bdaad35-fe73-4c69-a9ca-0f48a05cedd2"],

Cell[BoxData["16"], "Output",
 CellChangeTimes->{
  3.879950090159201*^9, {3.8799501556424932`*^9, 3.8799501735954437`*^9}, 
   3.879950403801264*^9, 3.882444506283786*^9, 3.8824445564971266`*^9, 
   3.8824448894992905`*^9, 3.882445153104752*^9, 3.882445831168295*^9, 
   3.8824459277627172`*^9, 3.8824459840714417`*^9, 3.882446021793152*^9, 
   3.882446158565725*^9, 3.882446191177264*^9, 3.8824462603929725`*^9, {
   3.882446332614156*^9, 3.8824463563601522`*^9}, 3.8824464152300425`*^9, {
   3.8824464562935*^9, 3.882446479452154*^9}, 3.8824465169652176`*^9, {
   3.882446557498245*^9, 3.8824467010668907`*^9}, {3.8824467350799932`*^9, 
   3.882446752073529*^9}, 3.8824467982129407`*^9, 3.8824481190710297`*^9, 
   3.8824482041586604`*^9, {3.882448252598935*^9, 3.8824484055506597`*^9}, {
   3.8824484361643353`*^9, 3.8824484489647503`*^9}, {3.882448483583685*^9, 
   3.8824485452920265`*^9}, {3.882448589390787*^9, 3.882448623847149*^9}, 
   3.8824486681820197`*^9, {3.8824487041996355`*^9, 3.8824487245410843`*^9}, {
   3.8824487559540043`*^9, 3.8824487770965896`*^9}, 3.8824489121825266`*^9, 
   3.8824494813896465`*^9, 3.88244977449606*^9, 3.9526808397634697`*^9, 
   3.9526809130216866`*^9, {3.95268096978454*^9, 3.9526809935587597`*^9}, 
   3.952681041379156*^9, 3.9526811354782524`*^9, 3.952681170922535*^9, 
   3.952681231815569*^9, 3.97239395560767*^9, {3.9723951514060936`*^9, 
   3.9723951870361805`*^9}, 3.972395458522835*^9, 3.972395610257658*^9, 
   3.972395803584673*^9, 3.9723958766841545`*^9, 3.9723959729139633`*^9, 
   3.9723960553258533`*^9},
 CellLabel->
  "Out[1235]=",ExpressionUUID->"4998843d-cf46-4e45-9abe-c678cf151a6f"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"statevec", " ", "=", " ", "x"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inputvec", " ", "=", " ", "u"}], ";"}]}], "Input",
 CellChangeTimes->{{3.86913983457501*^9, 3.86913984640261*^9}, 
   3.879949374555312*^9},
 CellLabel->
  "In[1236]:=",ExpressionUUID->"cbdf4846-7fdd-454d-aea3-9d3efb56337a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Process Model", "Section",
 CellChangeTimes->{
  3.8667979328524823`*^9, {3.8667996209390726`*^9, 3.8667996235920877`*^9}, {
   3.8668000468373036`*^9, 3.8668000478720675`*^9}, {3.8668028390302362`*^9, 
   3.8668028400923014`*^9}},ExpressionUUID->"959ddc13-2b92-4687-8d5a-\
bf5c8345372a"],

Cell[CellGroupData[{

Cell["Kinematics", "Subsubsection",
 CellChangeTimes->{{3.882444242377454*^9, 
  3.8824442465073833`*^9}},ExpressionUUID->"d1719704-d9e8-4c73-8b1d-\
d686a1e1654c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Wposdot", " ", "=", " ", "Wvel"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", "Wposdot", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8824442544091763`*^9, 3.8824442657855783`*^9}, {
   3.882445820555993*^9, 3.882445826683997*^9}, 3.9723954546955223`*^9},
 CellLabel->
  "In[1238]:=",ExpressionUUID->"afb21cdd-158a-4034-809e-1aa5fa494326"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalTheta]dot", " ", "=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", " ", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Phi]", "]"}], "*", 
         RowBox[{"Tan", "[", "\[Theta]", "]"}]}], ",", " ", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Phi]", "]"}], "*", 
         RowBox[{"Tan", "[", "\[Theta]", "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", " ", 
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Phi]", "]"}], "*", 
         RowBox[{"Sec", "[", "\[Theta]", "]"}]}], ",", " ", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Phi]", "]"}], "*", 
         RowBox[{"Sec", "[", "\[Theta]", "]"}]}]}], "}"}]}], "}"}], ".", 
    "\[CapitalOmega]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", "\[CapitalTheta]dot", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.882444269506466*^9, 3.8824444356787615`*^9}, 
   3.9723954533856983`*^9},
 CellLabel->
  "In[1240]:=",ExpressionUUID->"1fd72288-ff70-4a6e-bf92-5571d2c72dc3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rotational Dynamics", "Subsubsection",
 CellChangeTimes->{{3.866799674525009*^9, 
  3.8667996815237494`*^9}},ExpressionUUID->"4d9534e7-471e-44b1-a1c1-\
5ff902e3855a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalOmega]dot", " ", "=", " ", 
   RowBox[{"jmatInv", ".", 
    RowBox[{"(", 
     RowBox[{"Btotmoment", "-", " ", 
      RowBox[{"Cross", "[", 
       RowBox[{"\[CapitalOmega]", ",", " ", 
        RowBox[{"jmat", ".", "\[CapitalOmega]"}]}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", "\[CapitalOmega]dot", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8668002055196857`*^9, 3.8668002536518135`*^9}, {
   3.8668196215970554`*^9, 3.8668196226173596`*^9}, 3.8691405810008793`*^9, {
   3.8691473868408165`*^9, 3.8691473905255785`*^9}, {3.879949423972623*^9, 
   3.879949432795898*^9}, {3.879949889883095*^9, 3.8799498934676533`*^9}, {
   3.8799501710453835`*^9, 3.8799501716259456`*^9}, 3.879950299916072*^9, {
   3.8799503680150537`*^9, 3.879950387160877*^9}, {3.8824439955953493`*^9, 
   3.882443998986893*^9}, {3.882445871763379*^9, 3.882445899528825*^9}, 
   3.9723954510956745`*^9},
 CellLabel->
  "In[1242]:=",ExpressionUUID->"538a3054-abe7-4bbb-a158-6814696f65cc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Translational Dynamics", "Subsubsection",
 CellChangeTimes->{{3.8668002769342165`*^9, 
  3.8668002786335435`*^9}},ExpressionUUID->"f81da896-4268-4f4a-943f-\
8b810508f58a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Wveldot", " ", "=", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "/", "m"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"Wtotforce", " ", "+", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{
          RowBox[{"-", "m"}], "*", "g"}]}], "}"}]}], ")"}]}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", "Wveldot", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8668002913215237`*^9, 3.866800363753707*^9}, {
   3.8668004087780094`*^9, 3.866800437601799*^9}, {3.866802668917818*^9, 
   3.8668026863142366`*^9}, {3.8668158538505573`*^9, 3.866815863743681*^9}, {
   3.8668196204480968`*^9, 3.8668196209551*^9}, {3.8668236179349685`*^9, 
   3.8668236185413933`*^9}, {3.8691414376230545`*^9, 
   3.8691414656712613`*^9}, {3.879949439687883*^9, 3.8799495094652724`*^9}, 
   3.8799501702574043`*^9, {3.87995030394653*^9, 3.879950307674711*^9}, {
   3.882443964652381*^9, 3.8824440011358523`*^9}, 3.8824444482272716`*^9, {
   3.882445902440436*^9, 3.882445911169331*^9}, {3.882448224656456*^9, 
   3.882448273257291*^9}, {3.9723947333503056`*^9, 3.9723947338818073`*^9}, 
   3.9723954497259464`*^9},
 CellLabel->
  "In[1244]:=",ExpressionUUID->"8b7d05ad-d248-4b27-928e-c3feae10f48a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Bveldot", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "/", "m"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"Btotforce", " ", "+", " ", 
       RowBox[{"BRW", ".", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0", ",", " ", 
          RowBox[{
           RowBox[{"-", "m"}], "*", "g"}]}], "}"}]}]}], ")"}]}], " ", "-", 
    " ", 
    RowBox[{"Cross", "[", 
     RowBox[{"\[CapitalOmega]", ",", " ", "Bvel"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", "Bveldot", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9723949641507664`*^9, 3.9723950685629425`*^9}, {
   3.9723951072661343`*^9, 3.9723951199495716`*^9}, 3.972395448420246*^9, {
   3.972395968996126*^9, 3.972395991684084*^9}},
 CellLabel->
  "In[1246]:=",ExpressionUUID->"046561c0-fe8b-7e4c-807a-c5e7c96e07a8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Motor Dynamics", "Subsubsection",
 CellChangeTimes->{{3.8799495651001816`*^9, 
  3.879949575301365*^9}},ExpressionUUID->"8ba6dce6-e668-4ffe-827d-\
1440ba1bc258"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Eta]dot", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", "\[Tau]m"}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{"u", "-", "\[Eta]"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", "\[Eta]dot", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.879949705859724*^9, 3.8799497326195555`*^9}, {
   3.8799498416390615`*^9, 3.8799498452585173`*^9}, 3.8799503520027514`*^9, {
   3.8824459135545883`*^9, 3.882445922128558*^9}, 3.972395444902769*^9},
 CellLabel->
  "In[1248]:=",ExpressionUUID->"5ad900f2-fedb-48fc-9897-1fd99ea08d75"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wind Dynamics", "Subsubsection",
 CellChangeTimes->{{3.9526803121658096`*^9, 
  3.9526803193136215`*^9}},ExpressionUUID->"c9015d05-0a72-ed41-b480-\
0b5fceb0b5fa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Wwinddot", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", "3"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Bwinddot", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", " ", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", "Bwinddot", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9526803278866577`*^9, 3.9526803632662373`*^9}, {
   3.9723950992170258`*^9, 3.972395112706192*^9}, 3.972395446785902*^9},
 CellLabel->
  "In[1250]:=",ExpressionUUID->"649b2aec-8389-2943-9c44-7274af2b43bb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parameter Dynamics", "Subsubsection",
 CellChangeTimes->{{3.8668030350255737`*^9, 
  3.8668030389250793`*^9}},ExpressionUUID->"e8309ed0-d4b2-446c-9e51-\
7a2eca889527"],

Cell["Assume that the parameters do not change over time.", "Text",
 CellChangeTimes->{{3.8668031173051043`*^9, 
  3.86680312423886*^9}},ExpressionUUID->"d8c7f136-f332-4e22-b009-\
667a009283b7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"f", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
    "Bveldot", ",", " ", "\[CapitalTheta]dot", ",", "  ", 
     "\[CapitalOmega]dot", ",", " ", "\[Eta]dot", ",", " ", "Bwinddot"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.866819658120748*^9, 3.8668196674147635`*^9}, {
   3.866819758473287*^9, 3.866819759600043*^9}, {3.866819836692829*^9, 
   3.866819849026705*^9}, {3.8668202498138995`*^9, 3.8668202632841096`*^9}, {
   3.8668214411228175`*^9, 3.866821442519494*^9}, {3.8668219152075825`*^9, 
   3.866821923330767*^9}, {3.8668236393665776`*^9, 3.8668236429650145`*^9}, {
   3.867411756575963*^9, 3.867411765194234*^9}, {3.8674119875162935`*^9, 
   3.8674119894574175`*^9}, {3.867845376232191*^9, 3.8678453804442406`*^9}, {
   3.867846603953597*^9, 3.867846610578823*^9}, {3.8678477575100756`*^9, 
   3.867847762324705*^9}, {3.8678479440098248`*^9, 3.8678479441258335`*^9}, {
   3.8799498619852333`*^9, 3.879949910537364*^9}, 3.8799500352636137`*^9, {
   3.879950080592173*^9, 3.879950080669132*^9}, {3.8824445176693397`*^9, 
   3.882444544605546*^9}, {3.8824458470173154`*^9, 3.882445848900787*^9}, {
   3.882448899496852*^9, 3.8824489003741827`*^9}, 3.9526801914483147`*^9, 
   3.9526802230860767`*^9, {3.952680368931761*^9, 3.95268037178047*^9}, {
   3.9526809848469944`*^9, 3.9526809875154305`*^9}, {3.9526811290739403`*^9, 
   3.952681129133753*^9}, {3.972393814180538*^9, 3.9723938149679737`*^9}, {
   3.9723951299328117`*^9, 3.972395134467083*^9}, {3.9723955927936535`*^9, 
   3.9723955956280117`*^9}, {3.9723958215907135`*^9, 
   3.9723958217158756`*^9}, {3.9723958604043064`*^9, 3.9723958634894676`*^9}},
 CellLabel->
  "In[1253]:=",ExpressionUUID->"8d429586-9db5-47af-8524-d3f75db4214f"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "0"}], ",", 
    RowBox[{"i", "<=", 
     RowBox[{"Length", "[", "x", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{"Print", "[", 
     RowBox[{"f", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.8674172366624928`*^9, 3.867417249260277*^9}, 
   3.867417389403533*^9, {3.867769495149596*^9, 3.8677695022781353`*^9}, {
   3.8691521451392126`*^9, 3.8691521480520887`*^9}},
 CellLabel->
  "In[1254]:=",ExpressionUUID->"5b6c4fa1-1007-43e7-bda8-07cbfca8c1e3"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "0"}], ",", " ", 
    RowBox[{"i", "<=", 
     RowBox[{"Length", "[", "x", "]"}]}], ",", " ", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"Grad", "[", 
       RowBox[{"f", ",", "x"}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.867414956645775*^9, 3.8674149635821075`*^9}, {
   3.8674155807544084`*^9, 3.8674156041957207`*^9}, {3.8674156359910264`*^9, 
   3.867415674857868*^9}, {3.8674157065583363`*^9, 3.8674157481773386`*^9}, {
   3.8674157820068235`*^9, 3.8674158168455954`*^9}, {3.8674158867519984`*^9, 
   3.8674158885525837`*^9}, {3.8674159209863405`*^9, 3.867415923301449*^9}, {
   3.8674160289598875`*^9, 3.8674160317162504`*^9}, {3.867416285236247*^9, 
   3.867416289589456*^9}, 3.867416936373331*^9, {3.867845262158516*^9, 
   3.8678452811445255`*^9}},
 CellLabel->
  "In[1255]:=",ExpressionUUID->"e62858e6-1f1b-4b04-8015-21980c3cec0e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vecfield", " ", "=", "f"}], ";"}]], "Input",
 CellChangeTimes->{{3.869139908647934*^9, 3.8691399177554502`*^9}, {
  3.8824458545438952`*^9, 3.882445863794181*^9}, {3.9526809073908825`*^9, 
  3.952680916723776*^9}},
 CellLabel->
  "In[1256]:=",ExpressionUUID->"89337bda-5895-4ec2-a704-8255fc3edeb9"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Measurement Model", "Section",
 CellChangeTimes->{{3.8668032308643527`*^9, 
  3.866803233328534*^9}},ExpressionUUID->"449cc287-7927-4a6a-851d-\
9c58f213fd01"],

Cell["\<\
The measurement model includes the gyro and accelerometer measurements.\
\>", "Text",
 CellChangeTimes->{{3.8668035161758733`*^9, 3.8668035401980853`*^9}, {
  3.8668236704160624`*^9, 3.8668237921479006`*^9}, {3.952680559554384*^9, 
  3.9526805599454117`*^9}, {3.9723939011776333`*^9, 3.9723939233176403`*^9}, {
  3.9723959032642937`*^9, 
  3.9723959036843777`*^9}},ExpressionUUID->"26b03cad-3e18-4bde-a3da-\
e70e17c72cbf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"aAct", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", "m"}], ")"}], "*", " ", "Btotforce"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8668034395296783`*^9, 3.8668035118200493`*^9}, {
   3.8668045767122726`*^9, 3.866804582093184*^9}, {3.866804889420745*^9, 
   3.866804890866768*^9}, {3.8668158446726384`*^9, 3.866815845127303*^9}, {
   3.8691415026773567`*^9, 3.8691415060034685`*^9}, 3.8691476761165867`*^9, {
   3.8691487521510744`*^9, 3.8691487544626703`*^9}, {3.8691488072897115`*^9, 
   3.86914882654379*^9}, {3.8824446510542116`*^9, 3.882444688302951*^9}, {
   3.882444728552414*^9, 3.8824447743949566`*^9}, {3.882446184289426*^9, 
   3.882446187701288*^9}, {3.882446224582038*^9, 3.8824462565830927`*^9}, {
   3.882446574760235*^9, 3.882446744992338*^9}, {3.8824467884244347`*^9, 
   3.8824467889366384`*^9}, 3.972395907147436*^9},
 CellLabel->
  "In[1257]:=",ExpressionUUID->"fb80b3c8-71c9-49b7-9bed-bd4bfe623090"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"hAcc", " ", "=", " ", 
    RowBox[{"IRB", ".", "aAct"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hGyro", " ", "=", " ", 
    RowBox[{"IRB", ".", "\[CapitalOmega]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hVel", " ", "=", " ", "Bvel"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hPos", " ", "=", " ", "Wpos"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hAttitude", " ", "=", " ", "\[CapitalTheta]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hMotor", " ", "=", " ", "\[Eta]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8668035649695234`*^9, 3.8668036768278837`*^9}, {
   3.866804026311266*^9, 3.866804028063425*^9}, {3.8668074601196327`*^9, 
   3.8668075642465935`*^9}, {3.866820144450761*^9, 3.8668201548231707`*^9}, {
   3.866820226400272*^9, 3.8668202273701243`*^9}, 3.8668223309062843`*^9, {
   3.8668238020101414`*^9, 3.8668238289035397`*^9}, {3.8691474689471135`*^9, 
   3.8691474745378647`*^9}, {3.8691476636308513`*^9, 
   3.8691476677286005`*^9}, {3.8824447807286816`*^9, 
   3.8824448188343997`*^9}, {3.882446003800511*^9, 3.88244601217729*^9}, {
   3.9526804233857594`*^9, 3.9526804741059685`*^9}, {3.972393855719921*^9, 
   3.972393855975546*^9}, {3.9723938890905514`*^9, 3.972393892468149*^9}, {
   3.9723951399858074`*^9, 3.972395140166893*^9}},
 CellLabel->
  "In[1258]:=",ExpressionUUID->"dba81244-82d9-49a5-89b1-0cd4b53f5bd0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"h", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
    "hAcc", ",", "hGyro", ",", " ", "hVel", ",", " ", "hAttitude", ",", " ", 
     "hMotor"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQrVW35nn4+TeOq923vADRCq6aPZFAWnFt5wQQzfUw
cxGIXsB0cjGI/hm6c1kskH7h9BlMK7y5tgpEJ/I+ANOCxt83gWgbTcWtIDp1
2usdIJrFInoniFbZsv8diN64xvwTiGYTlfoOovX3xv0C0W/esTDFAWmRt0ms
IHrBmYPH44H0uwM3wfSLWRlNCUBaXam4A0SHHL5W33jhjeO36dVNIPqRKoNe
M5B+laGrD6L5N5xzANE2wYkuIFpg6sHEkItvHF3sXoBptkMhPaFAWo8/G0wv
WXqBSfct0N/W89lA9I3s5O8gmjv6Kph+eoXpL4hue8oHpk/wXT6qXPzW8ceK
wmMgGgArr7mf
  "],
 CellLabel->
  "In[1264]:=",ExpressionUUID->"3237417c-1157-41cf-b345-5cbefa62291e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"outputvec", " ", "=", "h"}], ";"}]], "Input",
 CellChangeTimes->{{3.8691398044507513`*^9, 3.8691398116163096`*^9}, {
   3.869141879788624*^9, 3.8691418802439437`*^9}, 3.8691420728462777`*^9, {
   3.8691424829658537`*^9, 3.8691424833250427`*^9}, {3.869147479679881*^9, 
   3.8691474838792305`*^9}, 3.8691488376485195`*^9, {3.8691490115077515`*^9, 
   3.869149011817413*^9}, {3.869149987160974*^9, 3.869149987324458*^9}, {
   3.869151035135927*^9, 3.8691510354183025`*^9}, 3.869151221179263*^9, 
   3.8824448395043964`*^9, {3.8824486886924086`*^9, 3.882448710406125*^9}},
 CellLabel->
  "In[1265]:=",ExpressionUUID->"473a80c5-1e5b-4803-930d-d13c560b2d79"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "0"}], ",", 
    RowBox[{"i", "<=", "15"}], ",", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{"Print", "[", 
     RowBox[{"h", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.867417134505823*^9, 3.867417149400755*^9}, 
   3.8674172322776814`*^9, 3.8679429291648903`*^9, {3.867942986486088*^9, 
   3.8679429999515*^9}, {3.8691521110219297`*^9, 3.8691521143569455`*^9}, {
   3.8824487163101945`*^9, 3.8824487697949286`*^9}},
 CellLabel->
  "In[1266]:=",ExpressionUUID->"50376c23-758f-483b-81d3-bb39b87fa7ba"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "0"}], ",", " ", 
    RowBox[{"i", "<=", 
     RowBox[{"Length", "[", "h", "]"}]}], ",", " ", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"Grad", "[", 
       RowBox[{"h", ",", "x"}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.867414362899313*^9, 3.8674143879943547`*^9}, {
   3.8674144726948414`*^9, 3.8674144761075068`*^9}, {3.867414603411124*^9, 
   3.867414611101454*^9}, {3.867414734576849*^9, 3.867414736962869*^9}, {
   3.8674147726202154`*^9, 3.8674147737905254`*^9}, {3.8674148046852245`*^9, 
   3.8674148846738586`*^9}, {3.867414937333898*^9, 3.8674149408212*^9}, {
   3.86741605471588*^9, 3.8674160636726036`*^9}, {3.867416175588132*^9, 
   3.8674161830023518`*^9}, {3.867416352066707*^9, 3.8674163574470043`*^9}, 
   3.8674169420214825`*^9, {3.867844891393088*^9, 3.8678449073496237`*^9}, 
   3.867845125619201*^9, {3.8678451602582965`*^9, 3.8678451646072235`*^9}, {
   3.867845296645715*^9, 3.8678453010410814`*^9}, {3.8691521208622513`*^9, 
   3.8691521287334538`*^9}, {3.882446150015915*^9, 3.882446152985458*^9}, 
   3.8824464496466503`*^9},
 CellLabel->
  "In[1267]:=",ExpressionUUID->"c5e1b0f1-c955-471c-b139-7ac7641b1df5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Observability Analysis", "Section",
 CellChangeTimes->{{3.866803222140773*^9, 
  3.8668032251524577`*^9}},ExpressionUUID->"33efd1c6-61ac-486d-afc3-\
7c8299b5c926"],

Cell[TextData[StyleBox["Automated Analysis", "Subsubsection"]], "Text",
 CellChangeTimes->{{3.866999833750265*^9, 3.866999836162888*^9}, {
  3.866999890527474*^9, 3.866999891121808*^9}, {3.867000687774873*^9, 
  3.867000690325183*^9}, {3.867000749774502*^9, 
  3.867000789038171*^9}},ExpressionUUID->"90f7e26e-529d-4ef7-8302-\
3615e66eb6b2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"lieseq", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", "1", "}"}], ",", 
      RowBox[{"{", "2", "}"}], ",", 
      RowBox[{"{", "3", "}"}], ",", 
      RowBox[{"{", "4", "}"}]}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Which", " ", "Lie", " ", "derivatives", " ", "to", " ", 
    RowBox[{"take", ".", " ", "Empty"}], " ", "set", " ", "is", " ", "the", " ",
     "output", " ", "function", " ", "itself"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.858369085481155*^9, 3.858369121715797*^9}, {
   3.8583693773467407`*^9, 3.858369383487494*^9}, 3.8583694530385227`*^9, {
   3.8583699574005337`*^9, 3.858369968305492*^9}, {3.85837009091819*^9, 
   3.858370094556326*^9}, {3.8583715104639273`*^9, 3.858371510933118*^9}, {
   3.858371658631997*^9, 3.8583716592799797`*^9}, {3.8583717402547283`*^9, 
   3.8583717572459297`*^9}, {3.858371791610064*^9, 3.8583717930437727`*^9}, {
   3.867000826516206*^9, 3.867000866197996*^9}, {3.8670041562009068`*^9, 
   3.867004213779434*^9}, {3.867004291170104*^9, 3.867004314400408*^9}, {
   3.867004428229884*^9, 3.867004429111272*^9}, {3.868772610825453*^9, 
   3.8687726145357943`*^9}, {3.868787776637097*^9, 3.868787783343882*^9}, {
   3.868787906193161*^9, 3.8687879324676657`*^9}, {3.868787966816004*^9, 
   3.868787968394449*^9}, {3.868788061427775*^9, 3.868788064192791*^9}},
 CellLabel->
  "In[1268]:=",ExpressionUUID->"3f250fc4-601e-4dfb-8c07-9aa46e562c10"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rule0", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"inputvec", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "->", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "inputvec", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8670018852884073`*^9, 3.8670019202711363`*^9}, 
   3.867002045042115*^9, 3.867002218613721*^9, {3.867002505487557*^9, 
   3.867002506644843*^9}, 3.8670025945332212`*^9},
 CellLabel->
  "In[1269]:=",ExpressionUUID->"f535196d-9a2e-4e77-ac0c-4949bd4b3708"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vecfield0", "=", 
   RowBox[{"vecfield", "/.", "rule0"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.867003859471212*^9, 3.867003874604765*^9}, 
   3.8687725420069113`*^9, 3.8687726471381683`*^9},
 CellLabel->
  "In[1270]:=",ExpressionUUID->"d09d4283-4f1b-4a0e-b0cc-23864f945429"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rules", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"inputvec", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "->", 
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"i", ",", "j"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", "inputvec", "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "inputvec", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8670019534840937`*^9, 3.8670020480012074`*^9}, 
   3.867002220049691*^9, {3.867002500069784*^9, 3.867002501798456*^9}, {
   3.8670025614659367`*^9, 3.8670025654894657`*^9}, 3.86700259579496*^9, 
   3.868772545799206*^9},
 CellLabel->
  "In[1271]:=",ExpressionUUID->"7f862c0e-d862-46b5-bdfe-c2f8941ad3f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cavecfields", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"vecfield", "-", "vecfield0"}], "/.", 
      RowBox[{"rules", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "inputvec", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.867000878024225*^9, 3.867000910430612*^9}, {
   3.8670009764430647`*^9, 3.867000989111466*^9}, {3.867001020222377*^9, 
   3.867001087714942*^9}, {3.867001154741754*^9, 3.867001204665612*^9}, {
   3.867001250803542*^9, 3.867001311829443*^9}, {3.8670013529395514`*^9, 
   3.86700136812969*^9}, {3.867001632701479*^9, 3.867001714270548*^9}, {
   3.867002269277337*^9, 3.867002334776029*^9}, {3.867002371640764*^9, 
   3.867002415962069*^9}, {3.867002461513464*^9, 3.867002461804837*^9}, 
   3.867002605760519*^9, 3.8670026664822206`*^9, {3.867003893897324*^9, 
   3.867003930984621*^9}, 3.8670039748591957`*^9, {3.867004328723596*^9, 
   3.867004339077692*^9}},
 CellLabel->
  "In[1272]:=",ExpressionUUID->"e500fdd3-a02c-4d7d-878d-cc7f68e28d24"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vecfields", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", "vecfield0", "}"}], ",", "cavecfields"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.867003944643764*^9, 3.867003962192892*^9}, 
   3.867004346900888*^9, 3.867004552512645*^9},
 CellLabel->
  "In[1273]:=",ExpressionUUID->"e6df3cee-054f-437e-bfb4-6e743f019570"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LieIterate", "[", 
    RowBox[{"h_", ",", "i_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Grad", "[", 
     RowBox[{"h", ",", "statevec"}], "]"}], ".", 
    RowBox[{"vecfields", "[", 
     RowBox[{"[", 
      RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.858370694051918*^9, 3.8583707717937603`*^9}, {
   3.858370924461882*^9, 3.858370933477372*^9}, {3.8583709684603*^9, 
   3.8583709827849607`*^9}, 3.858371231559536*^9, {3.867000011462678*^9, 
   3.867000012362355*^9}, {3.867000183579576*^9, 3.8670001989601603`*^9}, {
   3.8670039800777597`*^9, 3.867003981312199*^9}},
 CellLabel->
  "In[1274]:=",ExpressionUUID->"7e51ee01-0492-420f-81d9-42d8c67e9a84"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LieDerivative", "[", 
    RowBox[{"h_", ",", "seq_"}], "]"}], ":=", 
   RowBox[{"Fold", "[", 
    RowBox[{"LieIterate", ",", "h", ",", "seq"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.858370199002461*^9, 3.858370290694448*^9}, {
  3.858370325977517*^9, 3.858370484051387*^9}, {3.858370523871601*^9, 
  3.8583706226072893`*^9}, {3.858370790279188*^9, 3.8583707917611437`*^9}, {
  3.858370853343783*^9, 3.8583708878805943`*^9}, {3.858370937112349*^9, 
  3.8583709374667883`*^9}, {3.858370988342589*^9, 3.858371006210103*^9}},
 CellLabel->
  "In[1275]:=",ExpressionUUID->"6ac16663-e902-40ad-81d3-c178530e5a7a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lies", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"LieDerivative", "[", 
      RowBox[{"outputvec", ",", 
       RowBox[{"lieseq", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "lieseq", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.858369151398221*^9, 3.858369153835546*^9}, {
   3.8583692600762033`*^9, 3.85836931097908*^9}, {3.858369345408002*^9, 
   3.858369361868637*^9}, {3.858369398605341*^9, 3.858369450049843*^9}, {
   3.8583695239609613`*^9, 3.858369554130866*^9}, {3.858369779500404*^9, 
   3.858369929600534*^9}, {3.858369978595498*^9, 3.858369985012974*^9}, {
   3.8583700239907293`*^9, 3.858370024270218*^9}, {3.858371280870678*^9, 
   3.858371336447896*^9}, {3.858371582171386*^9, 3.858371582624586*^9}, {
   3.866999999560652*^9, 3.867000001824382*^9}, 3.867000308184389*^9, {
   3.867002616189268*^9, 3.867002620333054*^9}, {3.867004397898878*^9, 
   3.867004403114687*^9}, 3.8687725197046633`*^9, 3.868772639017864*^9},
 CellLabel->
  "In[1276]:=",ExpressionUUID->"170848c6-6607-48f1-96d9-757d6bf8c5c1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"obsvec", "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", "lies", "]"}], ",", "0"}], "]"}]}], ";", 
  RowBox[{"MatrixForm", "[", "obsvec", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.858371600324891*^9, 3.8583716369404173`*^9}, 
   3.8670009224022083`*^9, {3.867004373024466*^9, 3.867004381488009*^9}, 
   3.8670045652896976`*^9, {3.867004724035385*^9, 3.867004734079205*^9}, 
   3.8687726342783537`*^9},
 CellLabel->
  "In[1277]:=",ExpressionUUID->"6bbad13c-d1f8-4a1a-8168-00e403131ed5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"obsmat", "=", 
   RowBox[{"Grad", "[", 
    RowBox[{"obsvec", ",", "statevec"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.857856539793783*^9, 3.857856557081381*^9}, {
   3.8578569320652313`*^9, 3.8578569483156137`*^9}, {3.866999976482554*^9, 
   3.8669999784650106`*^9}, {3.86700013654547*^9, 3.8670001577633*^9}, 
   3.867000933482087*^9, {3.867002633201047*^9, 3.867002641964204*^9}, {
   3.867003992573123*^9, 3.8670040083396683`*^9}, 3.86700424011375*^9, {
   3.8824494695018206`*^9, 3.882449474773116*^9}},
 CellLabel->
  "In[1278]:=",ExpressionUUID->"f158c128-77fa-4a0e-a44e-b516e009cc7e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"params", "=", "statevec"}], ";"}]], "Input",
 CellChangeTimes->{{3.8687848538397627`*^9, 3.868784881229457*^9}, {
  3.8687873783728733`*^9, 3.868787385011219*^9}, {3.8691399987411566`*^9, 
  3.86914000230225*^9}},
 CellLabel->
  "In[1279]:=",ExpressionUUID->"b9aa1c24-4393-4616-8633-771c4687fbc9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"psub", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"i", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "params", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.868784885770146*^9, 3.868784906778557*^9}, {
   3.8687850456551228`*^9, 3.8687850621577473`*^9}, {3.8687851470669394`*^9, 
   3.868785160246677*^9}, {3.868785305976832*^9, 3.8687853062560062`*^9}, {
   3.868785342402733*^9, 3.8687853446484413`*^9}, 3.972395429525837*^9},
 CellLabel->
  "In[1280]:=",ExpressionUUID->"67112b30-22fc-45f2-8a3d-b12a615f5fb4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"psubrules", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"params", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "->", 
      RowBox[{"psub", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "params", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.868784910052619*^9, 3.868784945529489*^9}, 
   3.9723954285561905`*^9},
 CellLabel->
  "In[1281]:=",ExpressionUUID->"48249cd7-d7ae-40c5-9a56-5c9fea76434f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"obsmateval", "=", 
   RowBox[{"obsmat", "/.", "psubrules"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.868784952640636*^9, 3.868784979029911*^9}, {
  3.8691400888507557`*^9, 3.8691400900210147`*^9}},
 CellLabel->
  "In[1282]:=",ExpressionUUID->"56549c56-da48-463f-8e25-f594f83f61b7"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"NullSpace", "[", "obsmateval", "]"}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.8687851082068233`*^9, 3.868785113728736*^9}, {
   3.8691400956845407`*^9, 3.8691401213172894`*^9}, 3.869150698428664*^9, 
   3.8824497677484818`*^9},
 CellLabel->
  "In[1283]:=",ExpressionUUID->"82710685-cce8-4dd6-8ab6-a53ac2018557"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixRank", "[", "obsmateval", "]"}]], "Input",
 CellChangeTimes->{{3.8687849621995773`*^9, 3.868784984194418*^9}, {
  3.9723951676257687`*^9, 3.9723951819358845`*^9}},
 CellLabel->
  "In[1284]:=",ExpressionUUID->"b2fb898d-f5ba-4b0f-a577-2a79ed8b40da"],

Cell[BoxData["16"], "Output",
 CellChangeTimes->{3.972395187365999*^9, 3.9723956333650894`*^9, 
  3.972395812824194*^9, 3.9723958895703583`*^9, 3.9723959730869484`*^9, 
  3.9723960554682903`*^9},
 CellLabel->
  "Out[1284]=",ExpressionUUID->"07a1caf3-ccbd-4e42-9f01-e8ae7319b447"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "statevec", "]"}]], "Input",
 CellChangeTimes->{{3.868785018844081*^9, 3.868785022059453*^9}},
 CellLabel->
  "In[1285]:=",ExpressionUUID->"0cfb2002-0e9f-455f-953b-f6d30ae3f4aa"],

Cell[BoxData["16"], "Output",
 CellChangeTimes->{
  3.8824449257314034`*^9, 3.8824499508458652`*^9, 3.9526809038191204`*^9, {
   3.952680968158413*^9, 3.952680989399494*^9}, 3.9526810392991295`*^9, 
   3.9526810731169815`*^9, 3.9526811369354877`*^9, 3.952681220692663*^9, 
   3.9526812670929203`*^9, 3.972394000255501*^9, {3.97239515184466*^9, 
   3.9723951874160175`*^9}, 3.972395633415329*^9, 3.9723958128564777`*^9, 
   3.972395889586218*^9, 3.9723959731072407`*^9, 3.972396055483227*^9},
 CellLabel->
  "Out[1285]=",ExpressionUUID->"ef5bd8c3-97b5-0247-b4c7-9858efe1d9ca"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1428, 735.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
DockedCells->{},
Magnification:>0.9 Inherited,
FrontEndVersion->"14.2 for Microsoft Windows (64-bit) (December 26, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"4342da37-4465-43bd-9c1c-c405aea49cad"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 364, 7, 86, "Title",ExpressionUUID->"1bc5922d-ca10-4f41-a4da-454549fec2cc"],
Cell[947, 31, 367, 6, 46, "Subtitle",ExpressionUUID->"102ab1a5-78bc-49f4-beac-64501c2507e7"],
Cell[CellGroupData[{
Cell[1339, 41, 164, 3, 59, "Section",ExpressionUUID->"8a0ef6c2-7f27-4cdb-aedb-9df0d3be3377"],
Cell[CellGroupData[{
Cell[1528, 48, 230, 4, 39, "Subsubsection",ExpressionUUID->"9165a4d7-169d-4398-aced-7c9ac5d72c19"],
Cell[1761, 54, 617, 11, 30, "Text",ExpressionUUID->"f1eba1fd-c645-42e5-ae4b-6008f7d3abec"],
Cell[CellGroupData[{
Cell[2403, 69, 1401, 33, 72, "Input",ExpressionUUID->"a8bd066b-aa7a-43bc-b0d7-c0c6828401ee"],
Cell[3807, 104, 8186, 116, 41, "Output",ExpressionUUID->"0c0531a7-aa71-6545-b8ec-844b9462c9d7"]
}, Open  ]],
Cell[12008, 223, 784, 19, 38, "Input",ExpressionUUID->"4dc6eba7-2d7d-4316-a601-11480a42599e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12829, 247, 171, 3, 39, "Subsubsection",ExpressionUUID->"94e44778-561f-4c49-a0ec-68f4876517c8"],
Cell[13003, 252, 386, 9, 38, "Input",ExpressionUUID->"41102483-292e-43c5-a351-b7c533f0383e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13426, 266, 173, 3, 39, "Subsubsection",ExpressionUUID->"ad48e579-a9e2-4ec6-b4fc-688ea11bf14c"],
Cell[13602, 271, 1555, 35, 106, "Input",ExpressionUUID->"c4a40691-4620-4bf8-ba88-5805d4c0506b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15194, 311, 181, 3, 39, "Subsubsection",ExpressionUUID->"3ee51c0b-c96c-44a8-82a9-57b0f80da9ff"],
Cell[15378, 316, 605, 11, 50, "Text",ExpressionUUID->"409f6702-9328-4f96-9c1a-f249d4f47fb9"],
Cell[15986, 329, 361, 6, 38, "Input",ExpressionUUID->"46169f26-f452-4bde-a0c3-29c670c2aca2"],
Cell[16350, 337, 1235, 29, 106, "Input",ExpressionUUID->"ddd2b957-9208-4480-a097-a40f1a5ab919"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17622, 371, 182, 3, 39, "Subsubsection",ExpressionUUID->"284db6f0-fb7d-4e19-b123-7d4ce2b6c6e4"],
Cell[17807, 376, 381, 8, 30, "Text",ExpressionUUID->"644f1d55-4e72-4b0c-b93c-6b46194520bc"],
Cell[18191, 386, 480, 11, 38, "Input",ExpressionUUID->"4ecfafcf-4e8e-4046-a8b9-d084ca36dac2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18708, 402, 235, 4, 39, "Subsubsection",ExpressionUUID->"36e6cf5a-bbbf-4448-859e-458345ba5142"],
Cell[18946, 408, 353, 7, 30, "Text",ExpressionUUID->"f51abaf0-0256-47ce-a01f-d7cc30366a0b"],
Cell[CellGroupData[{
Cell[19324, 419, 2023, 50, 72, "Input",ExpressionUUID->"2144a647-e5b9-40b3-8927-281d9ec290b3"],
Cell[21350, 471, 3451, 52, 41, "Output",ExpressionUUID->"0dc3457a-161a-e942-8fbe-98c0387b40a0"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[24850, 529, 165, 3, 39, "Subsubsection",ExpressionUUID->"21e90ca2-2bd3-4b30-a5bf-b44915b0ca9c"],
Cell[25018, 534, 304, 7, 30, "Text",ExpressionUUID->"e4a240af-3aed-4e2e-bde2-5bafb7d35504"],
Cell[25325, 543, 636, 16, 55, "Input",ExpressionUUID->"5e060d44-a5f8-4ad5-be1c-36515c0ac24c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[26010, 565, 160, 3, 59, "Section",ExpressionUUID->"a604a669-c4f8-49bd-a574-9ae555ef816b"],
Cell[CellGroupData[{
Cell[26195, 572, 170, 3, 39, "Subsubsection",ExpressionUUID->"553a1ab9-20d4-423e-a457-0706819e2005"],
Cell[26368, 577, 364, 9, 38, "Input",ExpressionUUID->"ab6424f2-1d35-4a9b-b1a8-b7f28a2c79d4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26769, 591, 294, 4, 39, "Subsubsection",ExpressionUUID->"81361ef9-6d7d-45bc-969e-961be53e37db"],
Cell[27066, 597, 429, 7, 30, "Text",ExpressionUUID->"de8ef314-5fd5-4f00-926d-e4abb055bb9f"],
Cell[27498, 606, 1327, 32, 89, "Input",ExpressionUUID->"128354d4-8bd0-465a-b0fd-720f49c70571"],
Cell[28828, 640, 186, 3, 30, "Text",ExpressionUUID->"1b40e377-8145-49e4-9722-5fd7806509ef"],
Cell[29017, 645, 791, 21, 38, "Input",ExpressionUUID->"a6b34a7e-5b30-4cec-8c00-84cf937624ed"],
Cell[29811, 668, 738, 20, 38, "Input",ExpressionUUID->"5f407e1e-63f4-4b91-92fe-3a0c89f8c866"],
Cell[30552, 690, 742, 21, 38, "Input",ExpressionUUID->"72c0bb4c-d5bf-4c57-8921-956fde044411"],
Cell[31297, 713, 305, 7, 30, "Text",ExpressionUUID->"7aa606c7-9fb0-4879-8882-b7e6ac1a0c0d"],
Cell[CellGroupData[{
Cell[31627, 724, 436, 9, 38, "Input",ExpressionUUID->"211378ba-28f4-4442-93c5-d306cf9931e1"],
Cell[32066, 735, 4370, 94, 68, "Output",ExpressionUUID->"1dfc78c1-7370-9649-b28d-66b86b589b3a"]
}, Open  ]],
Cell[36451, 832, 243, 6, 30, "Text",ExpressionUUID->"09bef602-76d5-4532-9588-28fec998a1d6"],
Cell[CellGroupData[{
Cell[36719, 842, 374, 8, 38, "Input",ExpressionUUID->"b5c78ce9-e402-4801-9128-e91ceebe6242"],
Cell[37096, 852, 4324, 94, 68, "Output",ExpressionUUID->"1bcf6ea0-c0ad-2744-91e8-a087b59b25b6"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[41469, 952, 320, 5, 39, "Subsubsection",ExpressionUUID->"0fe80794-c1e9-41b8-95b6-9ce375e5a507"],
Cell[41792, 959, 831, 19, 55, "Input",ExpressionUUID->"47a92398-bfb3-485d-a72c-162cebfdc94e"],
Cell[42626, 980, 740, 17, 38, "Input",ExpressionUUID->"46d019b8-9126-421b-8eb1-7087ededb36d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43403, 1002, 281, 4, 39, "Subsubsection",ExpressionUUID->"80259df8-0181-4c69-a5b5-95f1597000a1"],
Cell[43687, 1008, 644, 15, 55, "Input",ExpressionUUID->"feb29a9e-3daa-4713-a8a0-f5af82387ceb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44368, 1028, 218, 4, 39, "Subsubsection",ExpressionUUID->"3c9fb6a6-91b5-4a93-9abe-56a833c10f34"],
Cell[44589, 1034, 381, 10, 38, "Input",ExpressionUUID->"5035a682-e4ad-45b5-838c-38c22e8a40b5"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[45019, 1050, 226, 4, 59, "Section",ExpressionUUID->"02e76445-37c5-41d0-a35a-f900f58483af"],
Cell[45248, 1056, 254, 4, 34, "Text",ExpressionUUID->"900b3d05-c12a-46a5-bd84-ca1d550ea726"],
Cell[45505, 1062, 320, 8, 38, "Input",ExpressionUUID->"2debed46-d329-43bc-8fa5-accb614955ea"],
Cell[45828, 1072, 194, 3, 34, "Text",ExpressionUUID->"bdac7858-1f67-473b-aa2d-45f8995568ec"],
Cell[CellGroupData[{
Cell[46047, 1079, 663, 12, 38, "Input",ExpressionUUID->"9fb4bdb8-e2e4-4c99-93ea-ae8897439d5d"],
Cell[46713, 1093, 8306, 119, 43, "Output",ExpressionUUID->"b5596442-7018-d443-9306-21e6424abbd0"]
}, Open  ]],
Cell[55034, 1215, 1207, 33, 89, "Input",ExpressionUUID->"cb6484dc-8ed7-4eb9-8323-d35c9daac72c"],
Cell[56244, 1250, 249, 4, 34, "Text",ExpressionUUID->"3fafea38-8e03-4cae-9d86-048f72d1552f"],
Cell[CellGroupData[{
Cell[56518, 1258, 686, 12, 38, "Input",ExpressionUUID->"1d677b38-e809-4c9c-b266-66569e9079f6"],
Cell[57207, 1272, 3617, 58, 43, "Output",ExpressionUUID->"05faabb7-245a-e14d-acf6-798d82dbdbdd"]
}, Open  ]],
Cell[60839, 1333, 1279, 33, 89, "Input",ExpressionUUID->"56218400-9327-4db2-a790-4f58861ca6ea"],
Cell[CellGroupData[{
Cell[62143, 1370, 266, 4, 39, "Subsubsection",ExpressionUUID->"f5c24af9-0233-4699-a59c-ea15749c53ba"],
Cell[62412, 1376, 225, 5, 30, "Text",ExpressionUUID->"6b1e8b0c-d7fd-4c64-9fce-16ee2496492a"],
Cell[62640, 1383, 1912, 38, 89, "Input",ExpressionUUID->"c60cc8da-a51a-4048-b82e-cf50a9c44b5f"],
Cell[64555, 1423, 1191, 25, 55, "Input",ExpressionUUID->"083a16f6-c4bc-4c2e-82a9-a78006d3efde"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[65795, 1454, 226, 4, 59, "Section",ExpressionUUID->"ffea0472-0335-4dae-b598-e7183b83a18d"],
Cell[66024, 1460, 639, 10, 50, "Text",ExpressionUUID->"dc464bce-8aa4-4887-bac5-c4d5fe9f9451"],
Cell[CellGroupData[{
Cell[66688, 1474, 173, 3, 39, "Subsubsection",ExpressionUUID->"ef8fe934-3d25-4d09-ab80-cc6d3ea4dba6"],
Cell[CellGroupData[{
Cell[66886, 1481, 1354, 36, 89, "Input",ExpressionUUID->"fa71a186-eb92-45ac-9e7d-06a55c9ea7fd"],
Cell[68243, 1519, 775, 18, 41, "Output",ExpressionUUID->"8e6e6818-356c-8648-9fc6-e93ed6f02929"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[69067, 1543, 164, 3, 39, "Subsubsection",ExpressionUUID->"d9bfeb6e-f53a-47b2-819a-a24fdbc747f4"],
Cell[69234, 1548, 1329, 39, 89, "Input",ExpressionUUID->"d431cc90-d1b9-4b78-b402-64eeba8db894"],
Cell[70566, 1589, 485, 10, 38, "Input",ExpressionUUID->"ef49e383-7ab7-4160-875d-7d5652688f19"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71088, 1604, 177, 3, 39, "Subsubsection",ExpressionUUID->"5b7f3476-da82-4c4b-9eda-b767ec01c30c"],
Cell[71268, 1609, 1121, 25, 123, "Input",ExpressionUUID->"e2c5c934-acca-46f6-98b4-dda8ba5f36de"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72426, 1639, 171, 3, 39, "Subsubsection",ExpressionUUID->"2e305805-57fe-8945-9af2-cd62adf7ae52"],
Cell[72600, 1644, 392, 9, 38, "Input",ExpressionUUID->"d3f2157e-75d5-e74a-94ff-61f720774def"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73029, 1658, 230, 4, 39, "Subsubsection",ExpressionUUID->"60146557-caa5-47fb-8c5f-6a8a0b569f91"],
Cell[73262, 1664, 593, 12, 55, "Input",ExpressionUUID->"4d583a60-bad8-44ae-943d-8edb4b19bacd"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[73904, 1682, 173, 3, 59, "Section",ExpressionUUID->"a892f4e5-65ef-407d-80c3-9f605d461e7e"],
Cell[74080, 1687, 251, 4, 30, "Text",ExpressionUUID->"a4dfecac-9b88-41cb-aa84-99b3809ca1ad"],
Cell[74334, 1693, 524, 11, 55, "Input",ExpressionUUID->"6b77ca35-18dd-436f-a1b7-0d4b60e51ce7"],
Cell[74861, 1706, 306, 7, 38, "Input",ExpressionUUID->"cabc6d91-238e-4196-85d3-927f77ac054e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[75204, 1718, 160, 3, 59, "Section",ExpressionUUID->"fa8abb0a-823c-4740-b8ef-d0ba6bc9f211"],
Cell[75367, 1723, 379, 9, 38, "Input",ExpressionUUID->"e21a0260-3dca-4199-a576-b437d858791b"],
Cell[CellGroupData[{
Cell[75771, 1736, 3398, 49, 38, "Input",ExpressionUUID->"7d072adf-663b-4710-a241-f0573464aa54"],
Cell[79172, 1787, 636, 13, 41, "Output",ExpressionUUID->"265b9047-4a32-8f4b-8295-a970052ca432"]
}, Open  ]],
Cell[79823, 1803, 229, 4, 38, "Input",ExpressionUUID->"31165ca4-4b7a-724e-9a5b-2c22edfe5e29"],
Cell[CellGroupData[{
Cell[80077, 1811, 295, 6, 38, "Input",ExpressionUUID->"2bdaad35-fe73-4c69-a9ca-0f48a05cedd2"],
Cell[80375, 1819, 1649, 24, 41, "Output",ExpressionUUID->"4998843d-cf46-4e45-9abe-c678cf151a6f"]
}, Open  ]],
Cell[82039, 1846, 345, 8, 55, "Input",ExpressionUUID->"cbdf4846-7fdd-454d-aea3-9d3efb56337a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82421, 1859, 294, 5, 59, "Section",ExpressionUUID->"959ddc13-2b92-4687-8d5a-bf5c8345372a"],
Cell[CellGroupData[{
Cell[82740, 1868, 163, 3, 39, "Subsubsection",ExpressionUUID->"d1719704-d9e8-4c73-8b1d-d686a1e1654c"],
Cell[82906, 1873, 404, 8, 55, "Input",ExpressionUUID->"afb21cdd-158a-4034-809e-1aa5fa494326"],
Cell[83313, 1883, 1271, 33, 55, "Input",ExpressionUUID->"1fd72288-ff70-4a6e-bf92-5571d2c72dc3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[84621, 1921, 172, 3, 39, "Subsubsection",ExpressionUUID->"4d9534e7-471e-44b1-a1c1-5ff902e3855a"],
Cell[84796, 1926, 1060, 21, 55, "Input",ExpressionUUID->"538a3054-abe7-4bbb-a158-6814696f65cc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85893, 1952, 177, 3, 39, "Subsubsection",ExpressionUUID->"f81da896-4268-4f4a-943f-8b810508f58a"],
Cell[86073, 1957, 1299, 28, 55, "Input",ExpressionUUID->"8b7d05ad-d248-4b27-928e-c3feae10f48a"],
Cell[87375, 1987, 890, 23, 55, "Input",ExpressionUUID->"046561c0-fe8b-7e4c-807a-c5e7c96e07a8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88302, 2015, 167, 3, 39, "Subsubsection",ExpressionUUID->"8ba6dce6-e668-4ffe-827d-1440ba1bc258"],
Cell[88472, 2020, 618, 14, 55, "Input",ExpressionUUID->"5ad900f2-fedb-48fc-9897-1fd99ea08d75"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89127, 2039, 168, 3, 39, "Subsubsection",ExpressionUUID->"c9015d05-0a72-ed41-b480-0b5fceb0b5fa"],
Cell[89298, 2044, 608, 14, 72, "Input",ExpressionUUID->"649b2aec-8389-2943-9c44-7274af2b43bb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89943, 2063, 173, 3, 39, "Subsubsection",ExpressionUUID->"e8309ed0-d4b2-446c-9e51-7a2eca889527"],
Cell[90119, 2068, 194, 3, 30, "Text",ExpressionUUID->"d8c7f136-f332-4e22-b009-667a009283b7"],
Cell[90316, 2073, 1755, 28, 38, "Input",ExpressionUUID->"8d429586-9db5-47af-8524-d3f75db4214f"],
Cell[92074, 2103, 605, 15, 38, "Input",ExpressionUUID->"5b6c4fa1-1007-43e7-bda8-07cbfca8c1e3"],
Cell[92682, 2120, 1040, 22, 38, "Input",ExpressionUUID->"e62858e6-1f1b-4b04-8015-21980c3cec0e"],
Cell[93725, 2144, 333, 7, 38, "Input",ExpressionUUID->"89337bda-5895-4ec2-a704-8255fc3edeb9"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[94107, 2157, 164, 3, 59, "Section",ExpressionUUID->"449cc287-7927-4a6a-851d-9c58f213fd01"],
Cell[94274, 2162, 432, 8, 30, "Text",ExpressionUUID->"26b03cad-3e18-4bde-a3da-e70e17c72cbf"],
Cell[94709, 2172, 982, 18, 38, "Input",ExpressionUUID->"fb80b3c8-71c9-49b7-9bed-bd4bfe623090"],
Cell[95694, 2192, 1476, 29, 123, "Input",ExpressionUUID->"dba81244-82d9-49a5-89b1-0cd4b53f5bd0"],
Cell[97173, 2223, 719, 17, 38, "Input",ExpressionUUID->"3237417c-1157-41cf-b345-5cbefa62291e"],
Cell[97895, 2242, 688, 11, 38, "Input",ExpressionUUID->"473a80c5-1e5b-4803-930d-d13c560b2d79"],
Cell[98586, 2255, 644, 15, 38, "Input",ExpressionUUID->"50376c23-758f-483b-81d3-bb39b87fa7ba"],
Cell[99233, 2272, 1335, 26, 38, "Input",ExpressionUUID->"c5e1b0f1-c955-471c-b139-7ac7641b1df5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100605, 2303, 169, 3, 59, "Section",ExpressionUUID->"33efd1c6-61ac-486d-afc3-7c8299b5c926"],
Cell[100777, 2308, 341, 5, 34, "Text",ExpressionUUID->"90f7e26e-529d-4ef7-8302-3615e66eb6b2"],
Cell[101121, 2315, 1547, 29, 38, "Input",ExpressionUUID->"3f250fc4-601e-4dfb-8c07-9aa46e562c10"],
Cell[102671, 2346, 610, 16, 38, "Input",ExpressionUUID->"f535196d-9a2e-4e77-ac0c-4949bd4b3708"],
Cell[103284, 2364, 313, 7, 38, "Input",ExpressionUUID->"d09d4283-4f1b-4a0e-b0cc-23864f945429"],
Cell[103600, 2373, 920, 24, 38, "Input",ExpressionUUID->"7f862c0e-d862-46b5-bdfe-c2f8941ad3f3"],
Cell[104523, 2399, 1144, 24, 38, "Input",ExpressionUUID->"e500fdd3-a02c-4d7d-878d-cc7f68e28d24"],
Cell[105670, 2425, 377, 10, 38, "Input",ExpressionUUID->"e6df3cee-054f-437e-bfb4-6e743f019570"],
Cell[106050, 2437, 738, 17, 38, "Input",ExpressionUUID->"7e51ee01-0492-420f-81d9-42d8c67e9a84"],
Cell[106791, 2456, 662, 13, 38, "Input",ExpressionUUID->"6ac16663-e902-40ad-81d3-c178530e5a7a"],
Cell[107456, 2471, 1203, 24, 38, "Input",ExpressionUUID->"170848c6-6607-48f1-96d9-757d6bf8c5c1"],
Cell[108662, 2497, 556, 12, 38, "Input",ExpressionUUID->"6bbad13c-d1f8-4a1a-8168-00e403131ed5"],
Cell[109221, 2511, 637, 12, 38, "Input",ExpressionUUID->"f158c128-77fa-4a0e-a44e-b516e009cc7e"],
Cell[109861, 2525, 332, 7, 38, "Input",ExpressionUUID->"b9aa1c24-4393-4616-8633-771c4687fbc9"],
Cell[110196, 2534, 615, 14, 38, "Input",ExpressionUUID->"67112b30-22fc-45f2-8a3d-b12a615f5fb4"],
Cell[110814, 2550, 575, 17, 38, "Input",ExpressionUUID->"48249cd7-d7ae-40c5-9a56-5c9fea76434f"],
Cell[111392, 2569, 317, 7, 38, "Input",ExpressionUUID->"56549c56-da48-463f-8e25-f594f83f61b7"],
Cell[111712, 2578, 371, 8, 38, "Input",ExpressionUUID->"82710685-cce8-4dd6-8ab6-a53ac2018557"],
Cell[CellGroupData[{
Cell[112108, 2590, 277, 5, 38, "Input",ExpressionUUID->"b2fb898d-f5ba-4b0f-a577-2a79ed8b40da"],
Cell[112388, 2597, 279, 5, 41, "Output",ExpressionUUID->"07a1caf3-ccbd-4e42-9f01-e8ae7319b447"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112704, 2607, 216, 4, 38, "Input",ExpressionUUID->"0cfb2002-0e9f-455f-953b-f6d30ae3f4aa"],
Cell[112923, 2613, 575, 9, 41, "Output",ExpressionUUID->"ef5bd8c3-97b5-0247-b4c7-9858efe1d9ca"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

